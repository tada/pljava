<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/markdown/examples/examples.md.vm at 2025-03-23

 | Rendered using Apache Maven Default Skin
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>PostgreSQL PL/Java &#x2013; The examples built with PL/Java</title>
    <link rel="stylesheet" href="../css/maven-base.css" />
    <link rel="stylesheet" href="../css/maven-theme.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
  </head>
  <body class="composite">
    <div id="banner">
<a href="https://tada.github.io/pljava/" id="bannerLeft" title="PL/Java logo combining the PostgreSQL elephant and a Java bean"><img src="../images/pljava_logo.jpg"  alt="PL/Java logo combining the PostgreSQL elephant and a Java bean"/></a>      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2025-03-23</span>
           | <span id="projectVersion">Version: 1.6.9</span>
      </div>
      <div class="xright"><a href="https://github.com/tada/pljava/wiki/" class="externalLink" title="Wiki">Wiki</a> |
<a href="https://github.com/tada/pljava/issues" class="externalLink" title="Issues">Issues</a> |
<a href="https://www.postgresql.org/list/pljava-dev/" class="externalLink" title="Mailing list">Mailing list</a> |
<a href="https://github.com/tada/pljava/tree/master/" class="externalLink" title="Code">Code</a>      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>Usage</h5>
    <ul>
     <li class="none"><a href="../build/build.html" title="Building PL/Java">Building PL/Java</a></li>
     <li class="none"><a href="../install/install.html" title="Installing into PostgreSQL">Installing into PostgreSQL</a></li>
     <li class="none"><a href="../install/upgrade.html" title="Upgrading">Upgrading</a></li>
     <li class="none"><a href="../build/package.html" title="Packaging PL/Java">Packaging PL/Java</a></li>
     <li class="none"><a href="../use/use.html" title="User guide">User guide</a></li>
     <li class="none"><a href="../develop/develop.html" title="Developer notes">Developer notes</a></li>
    </ul>
       <h5>Release Information</h5>
    <ul>
     <li class="none"><a href="../releasenotes.html" title="Release notes">Release notes</a></li>
    </ul>
       <h5>Modules</h5>
    <ul>
     <li class="none"><a href="../pljava-api/index.html" title="PL/Java API">PL/Java API</a></li>
     <li class="none"><a href="../pljava/index.html" title="PL/Java backend Java code">PL/Java backend Java code</a></li>
     <li class="none"><a href="../pljava-so/index.html" title="PL/Java backend native code">PL/Java backend native code</a></li>
     <li class="none"><a href="../pljava-ant/index.html" title="PL/Java Ant tasks">PL/Java Ant tasks</a></li>
     <li class="none"><a href="../pljava-examples/index.html" title="PL/Java examples">PL/Java examples</a></li>
     <li class="none"><a href="../pljava-packaging/index.html" title="PL/Java packaging">PL/Java packaging</a></li>
     <li class="none"><a href="../pljava-pgxs/index.html" title="PL/Java PGXS">PL/Java PGXS</a></li>
    </ul>
       <h5>Project Documentation</h5>
    <ul>
     <li class="collapsed"><a href="../project-info.html" title="Project Information">Project Information</a></li>
    </ul>
      <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
<h1>The examples built with PL/Java</h1>
<p>The PL/Java source includes a number of <a class="externalLink" href="https://github.com/tada/pljava/tree/master//pljava-examples/src/main/java/org/postgresql/pljava/example">examples</a> that are built into
a jar that can be installed in the same way as a jar of your own PL/Java
functions and types.</p>
<p>You can extract <code>examples.jar</code> from the <a href="../install/locate.html">packaged archive</a>, or use
the direct path to where it was built: relative to the build root,
<code>pljava-examples/target/pljava-examples-${project.version}.jar</code>, with
<code>${project.version}</code> expanded the obvious way, for example
<code>1.6.9</code>.</p><section>
<h2><a name="Loading_the_examples"></a>Loading the examples</h2>
<p>Assuming you are connected to a database where PL/Java has been successfully
loaded, use the <code>sqlj.install_jar</code> function, which takes three parameters.
The first is a URL to the jar file to be loaded. The simplest case would be
a <code>file:</code> URL giving a path on the PostgreSQL server host to the jar file,
with permissions set so the backend can read it. Other forms of URL are also
accepted, so <code>install_jar</code> could retrieve a jar from the web, for example.</p>
<p>The second parameter is a short name to identify the jar within PL/Java,
and the third is a boolean controlling whether to execute the
<a class="externalLink" href="https://github.com/tada/pljava/wiki/Sql-deployment-descriptor">deployment descriptor</a> included in the jar as part of installing it.</p>
<p>Therefore:</p>

<div class="source">
<pre><code class="language-sql">SELECT sqlj.install_jar(
  'file:'
  '/buildroot/pljava-examples/target/pljava-examples-1.6.9.jar',
  'examples', true);
</code></pre></div>
<p>will install the <code>examples.jar</code> file (assuming the build was done in
<code>/buildroot</code>), giving it the identifier <code>examples</code> and executing the
deployment descriptor.</p>
<p>A typical deployment descriptor will merely declare functions or types provided
by the jar, create tables they rely on, etc. The <code>examples.jar</code> deployment
descriptor goes farther, and calls several functions provided as test cases,
so this use of <code>install_jar</code> may take a few extra seconds and produce some
test-related output. (To see <i>successful</i> test-related output, be sure to
set <code>client_min_messages</code> to a level at least as detailed as <code>INFO</code> before
the session's first use of PL/Java.)</p>
<p><b>See the end of this page if your attempt to install the examples jar
fails with &#x201c;unable to find static method&#x201d; or &#x201c;no such class&#x201d; messages.</b></p></section><section>
<h2><a name="Trying_the_examples"></a>Trying the examples</h2>
<p>While the deployment descriptor itself runs some of the examples, once the
jar is installed, they are all available for you to run, as functions in
the <code>javatest</code> schema.</p>
<p>First, be sure the <code>javatest</code> schema is on your <code>search_path</code>:</p>

<div class="source">
<pre><code class="language-sql">SHOW search_path;
</code></pre></div>
<p>It will be, after <code>install_jar</code> returns (though that is arguably a bug and
could change), but that will not persist into new sessions.</p>
<p>Make sure that the Java classpath for that schema includes the ID for this
jar:</p>

<div class="source">
<pre><code class="language-sql">SELECT sqlj.get_classpath('javatest');
</code></pre></div>
<p>If it does not, set the classpath:</p>

<div class="source">
<pre><code class="language-sql">SELECT sqlj.set_classpath('javatest', 'examples');
</code></pre></div>
<p>Then use some example function:</p>

<div class="source">
<pre><code class="language-sql"> SELECT javatest.java_addone(3);
 java_addone 
-------------
           4
</code></pre></div></section><section>
<h2><a name="Optionally-built_example_code"></a>Optionally-built example code</h2>
<p>Some example code is included in source form but not built by default,
because it assumes a later Java version than PL/Java should require to build,
or pulls in extra libraries, or both. Optional examples can be built by adding
corresponding <code>-P</code> profile options to the <code>mvn</code> command line when building.</p><section>
<h3><a name="Using_the_Saxon_XML-processing_library_for_true_XMLQUERY_and_XMLTABLE"></a>Using the Saxon XML-processing library for true <code>XMLQUERY</code> and <code>XMLTABLE</code></h3>
<p>In the source directory <code>org/postgresql/pljava/example/saxon</code> is example code
for XML processing functions similar to <code>XMLCAST</code>, <code>XMLEXISTS</code>, <code>XMLQUERY</code>, and
<code>XMLTABLE</code> but using
the XQuery language as the SQL/XML standard actually specifies (in contrast
to the similar functions built into PostgreSQL, which support only XPath,
and XPath 1.0, at that).</p>
<p>This code is not built by default because it pulls in the sizeable <a class="externalLink" href="http://www.saxonica.com/html/products/products.html">Saxon-HE</a>
library from Saxonica, and because it requires Java 8.</p>
<p>To include these optional functions when building the examples, be sure to use
a Java 8 or later build environment, and add <code>-Psaxon-examples</code> to the <code>mvn</code>
command line.</p>
<p>The Saxon example <a href="../examples/saxon.html">documentation is here</a>.</p></section></section><section>
<h2><a name="Exception_resolving_class_or_method_.28message_when_installing_examples.29"></a>Exception resolving class or method (message when installing examples)</h2>
<p>As described above, there are some optionally-built examples included
in the source. For example, there are XML Query examples that are not built
by default because they depend on the Saxon jar.</p>
<p>If your examples jar was built with the optional examples enabled, then
PL/Java will normally validate that all of the functions it creates can be used.
That validation can fail if a needed dependency, such as the Saxon jar, is
not already installed and on the classpath. The error message will not directly
say the Saxon jar is missing, but may say it failed to find a class (whose name
will suggest it should be part of Saxon).</p>
<p>There are two ways to proceed:</p>
<ul>

<li>

<p>Install the required dependency first. Use <code>sqlj.install_jar</code> to install
the Saxon jar (as described <a href="../examples/saxon.html">here</a>), and
<code>sqlj.set_classpath</code> to make it accessible, and <i>then</i> use
<code>sqlj.install_jar</code> to install the examples jar itself. The dependency will
be satisfied and all of the example functions will work.</p>
</li>
<li>

<p>Use <code>SET check_function_bodies TO off</code> before installing the examples jar.
That will simply relax the strict checking at <code>CREATE FUNCTION</code> time, so
that all of the example functions will be created. The ones that require
Saxon, of course, won't work; <code>SET check_function_bodies TO off</code> simply
means you get the errors later, when trying to use the functions, instead
of when creating them. If you install the dependency jar later and
add it to the class path, those functions will then work.</p>
</li>
</ul></section>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2003&#x2013;2025<a href="http://tada.se/eng/">Tada AB</a>.
.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
