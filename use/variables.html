<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src/site/markdown/use/variables.md at 2023-09-19

 | Rendered using Apache Maven Default Skin
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <title>PostgreSQL PL/Java &#x2013; PL/Java configuration variable reference</title>
    <link rel="stylesheet" href="../css/maven-base.css" />
    <link rel="stylesheet" href="../css/maven-theme.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
  </head>
  <body class="composite">
    <div id="banner">
<a href="https://tada.github.io/pljava/" id="bannerLeft" title="PL/Java logo combining the PostgreSQL elephant and a Java bean"><img src="../images/pljava_logo.jpg"  alt="PL/Java logo combining the PostgreSQL elephant and a Java bean"/></a>      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2023-09-19</span>
          &#xA0;| <span id="projectVersion">Version: 1.6.6</span>
      </div>
      <div class="xright"><a href="https://github.com/tada/pljava/wiki/" class="externalLink" title="Wiki">Wiki</a> |
<a href="https://github.com/tada/pljava/issues" class="externalLink" title="Issues">Issues</a> |
<a href="https://www.postgresql.org/list/pljava-dev/" class="externalLink" title="Mailing list">Mailing list</a> |
<a href="https://github.com/tada/pljava/tree/master/" class="externalLink" title="Code">Code</a>      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>Usage</h5>
    <ul>
     <li class="none"><a href="../build/build.html" title="Building PL/Java">Building PL/Java</a></li>
     <li class="none"><a href="../install/install.html" title="Installing into PostgreSQL">Installing into PostgreSQL</a></li>
     <li class="none"><a href="../install/upgrade.html" title="Upgrading">Upgrading</a></li>
     <li class="none"><a href="../build/package.html" title="Packaging PL/Java">Packaging PL/Java</a></li>
     <li class="none"><a href="../use/use.html" title="User guide">User guide</a></li>
     <li class="none"><a href="../develop/develop.html" title="Developer notes">Developer notes</a></li>
    </ul>
       <h5>Release Information</h5>
    <ul>
     <li class="none"><a href="../releasenotes.html" title="Release notes">Release notes</a></li>
    </ul>
       <h5>Modules</h5>
    <ul>
     <li class="none"><a href="../pljava-api/index.html" title="PL/Java API">PL/Java API</a></li>
     <li class="none"><a href="../pljava/index.html" title="PL/Java backend Java code">PL/Java backend Java code</a></li>
     <li class="none"><a href="../pljava-so/index.html" title="PL/Java backend native code">PL/Java backend native code</a></li>
     <li class="none"><a href="../pljava-ant/index.html" title="PL/Java Ant tasks">PL/Java Ant tasks</a></li>
     <li class="none"><a href="../pljava-examples/index.html" title="PL/Java examples">PL/Java examples</a></li>
     <li class="none"><a href="../pljava-packaging/index.html" title="PL/Java packaging">PL/Java packaging</a></li>
     <li class="none"><a href="../pljava-pgxs/index.html" title="PL/Java PGXS">PL/Java PGXS</a></li>
    </ul>
       <h5>Project Documentation</h5>
    <ul>
     <li class="collapsed"><a href="../project-info.html" title="Project Information">Project Information</a></li>
    </ul>
      <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
<h1>PL/Java configuration variable reference</h1>
<p>These PostgreSQL configuration variables can influence PL/Java&#x2019;s operation:</p>
<dl>

<dt><code>check_function_bodies</code></dt>
<dd>Although not technically a PL/Java variable, <code>check_function_bodies</code> affects how strictly PL/Java validates a new function at the time of a <code>CREATE FUNCTION</code> (or when installing a jar file with <code>CREATE FUNCTION</code> among its deployment actions). With <code>check_function_bodies</code> set to <code>on</code>, PL/Java will make sure that the referenced class and method can be loaded and resolved. If the referenced class depends on classes in other jars, those other jars must be already installed and on the class path, so loading jars with dependencies in the wrong order can incur validation errors. With <code>check_function_bodies</code> set to <code>off</code>, only basic syntax is checked at <code>CREATE FUNCTION</code> time, so it is possible to declare functions or install jars in any order, postponing any errors about unresolved dependencies until later when the functions are used.</dd>
<dt><code>dynamic_library_path</code></dt>
<dd>Another non-PL/Java variable, <code>dynamic_library_path</code> influences where the PL/Java native code object (<code>.so</code>, <code>.dll</code>, <code>.bundle</code>, etc.) can be found, if the full path is not given to the <code>LOAD</code> command.</dd>
<dt><code>server_encoding</code></dt>
<dd>Another non-PL/Java variable, this affects all text/character strings exchanged between PostgreSQL and Java. <code>UTF8</code> as the database and server encoding is strongly recommended. If a different encoding is used, it should be any of the available <i>fully defined</i> character encodings. In particular, the PostgreSQL pseudo-encoding <code>SQL_ASCII</code> does not fully define what any values outside ASCII represent; it is usable, but <a href="charsets.html#Using_PLJava_with_server_encoding_SQL_ASCII">subject to limitations</a>.</dd>
<dt><code>pljava.debug</code></dt>
<dd>A boolean variable that, if set <code>on</code>, stops the process on first entry to PL/Java before the Java virtual machine is started. The process cannot proceed until a debugger is attached and used to set the static <code>Backend.c</code> variable <code>pljavaDebug</code> to zero. This may be useful for debugging PL/Java problems only seen in the context of some larger application that can&#x2019;t be stepped through.</dd>
<dt><code>pljava.enable</code></dt>
<dd>Setting this variable <code>off</code> prevents PL/Java startup from completing, until the variable is later set <code>on</code>. It can be useful when <a href="../install/prepg92.html">installing PL/Java on PostgreSQL versions before 9.2</a>.</dd>
<dt><code>pljava.implementors</code></dt>
<dd>A list of &#x201c;implementor names&#x201d; that PL/Java will recognize when processing <a class="externalLink" href="https://github.com/tada/pljava/wiki/Sql-deployment-descriptor">deployment descriptors</a> inside a jar file being installed or removed. Deployment descriptors can contain commands with no implementor name, which will be executed always, or with an implementor name, executed only on a system recognizing that name. By default, this list contains only the entry <code>postgresql</code>. A deployment descriptor that contains commands with other implementor names can achieve a rudimentary kind of conditional execution if earlier commands adjust this list of names. <i>Commas separate elements of this list. Elements that are not regular identifiers need to be surrounded by double-quotes; prior to PostgreSQL 11, that syntax can be used directly in a <code>SET</code> command, while in 11 and after, such a value needs to be a (single-quoted) string explicitly containing the double quotes.</i></dd>
<dt><code>pljava.java_thread_pg_entry</code></dt>
<dd>A choice of <code>allow</code>, <code>error</code>, <code>block</code>, or <code>throw</code> controlling PL/Java&#x2019;s thread management. Java makes heavy use of threading, while PostgreSQL may not be accessed by multiple threads concurrently. PL/Java&#x2019;s historical behavior is <code>allow</code>, which serializes access by Java threads into PostgreSQL, allowing a different Java thread in only when the current one calls or returns into Java. PL/Java formerly made some use of Java object finalizers, which required this approach, as finalizers run in their own thread.
<p>PL/Java itself no longer requires the ability for any thread to access PostgreSQL other than the original main thread. User code developed for PL/Java, however, may still rely on that ability. To test whether it does, the <code>error</code> or <code>throw</code> setting can be used here, and any attempt by a Java thread other than the main one to enter PostgreSQL will incur an exception (and stack trace, written to the server&#x2019;s standard error channel). When confident that there is no code that will need to enter PostgreSQL except on the main thread, the <code>block</code> setting can be used. That will eliminate PL/Java&#x2019;s frequent lock acquisitions and releases when the main thread crosses between PostgreSQL and Java, and will simply indefinitely block any other Java thread that attempts to enter PostgreSQL. This is an efficient setting, but can lead to blocked threads or a deadlocked backend if used with code that does attempt to access PG from more than one thread. (A JMX client, like JConsole, can identify the blocked threads, should that occur.)</p>
<p>The <code>throw</code> setting is like <code>error</code> but more efficient: under the <code>error</code> setting, attempted entry by the wrong thread is detected in the native C code, only after a lock operation and call through JNI. Under the <code>throw</code> setting, the lock operations are elided and an entry attempt by the wrong thread results in no JNI call and an exception thrown directly in Java.</p></dd>
<dt><code>pljava.libjvm_location</code></dt>
<dd>Used by PL/Java to load the Java runtime. The full path to a <code>libjvm</code> shared object (filename typically ending with <code>.so</code>, <code>.dll</code>, or <code>.dylib</code>). To determine the proper setting, see <a href="../install/locatejvm.html">finding the <code>libjvm</code> library</a>.</dd>
<dt><code>pljava.module_path</code></dt>
<dd>The module path to be passed to the Java application class loader. The default is computed from the PostgreSQL configuration and is usually correct, unless PL/Java&#x2019;s files have been installed in unusual locations. If it must be set explicitly, there must be at least two (and usually only two) entries, the PL/Java API jar file and the PL/Java internals jar file. To determine the proper setting, see <a href="../install/locate.html">finding the files produced by a PL/Java build</a>.
<p>If additional modular jars are added to the module path, <code>--add-modules</code> in <a href="../install/vmoptions.html#Adding_to_the_set_of_readable_modules"><code>pljava.vmoptions</code></a> will make them readable by PL/Java code.</p>
<p>For more on PL/Java&#x2019;s &#x201c;module path&#x201d; and &#x201c;class path&#x201d;, see <a href="jpms.html">PL/Java and the Java Platform Module System</a>.</p></dd>
<dt><code>pljava.policy_urls</code></dt>
<dd>A list of URLs to Java security <a href="policy.html">policy files</a> determining the permissions available to PL/Java functions. Each URL should be enclosed in double quotes; any double quote that is literally part of the URL may be represented as two double quotes (in SQL style) or as <code>%22</code> in the URL convention. Between double-quoted URLs, a comma is the list delimiter.
<p>The Java installation&#x2019;s <code>java.security</code> file usually defines two policy file locations:</p>
<ol style="list-style-type: decimal">

<li>A systemwide policy from the Java vendor, sufficient for the Java runtime itself to function as expected</li>
<li>A per-user location, where a policy file, if found, can add to the policy from the systemwide file.</li>
</ol>
<p>The list in <code>pljava.policy_urls</code> will modify the list from the Java installation, by default after the first entry, keeping the Java-supplied systemwide policy but replacing the customary per-user file (there probably isn&#x2019;t one in the home of the <code>postgres</code> user, and if there is it is probably not tailored for PL/Java).</p>
<p>Any entry in this list can start with <i>n</i><code>=</code> (inside the quotes) for a positive integer <i>n</i>, to specify which entry of Java&#x2019;s policy location list it will replace (entry 1 is the systemwide policy, 2 the customary user location). URLs not prefixed with <i>n</i><code>=</code> will follow consecutively. If the first entry is not so prefixed, <code>2=</code> is assumed.</p>
<p>A final entry of <code>=</code> (in the required double quotes) will prevent use of any remaining entries in the Java site-configured list.</p>
<p>This setting defaults to <code>&quot;file:${org.postgresql.sysconfdir}/pljava.policy&quot;,&quot;=&quot;</code></p>
</dd>
<dt><code>pljava.release_lingering_savepoints</code></dt>
<dd>How the return from a PL/Java function will treat any savepoints created within it that have not been explicitly either released (the savepoint analog of &#x201c;committed&#x201d;) or rolled back and released. If <code>off</code> (the default), they will be rolled back. If <code>on</code>, they will be released/committed. If possible, rather than setting this variable <code>on</code>, it would be safer to fix the function to release its own savepoints when appropriate.
<p>A savepoint continues to exist after being used as a rollback target. This is JDBC-specified behavior, but was not PL/Java&#x2019;s behavior before release 1.5.3, so code may exist that did not explicitly release or roll back a savepoint after rolling back to it once. To avoid a behavior change for such code, PL/Java will always release a savepoint that is still live at function return, regardless of this setting, if the savepoint has already been rolled back.</p></dd>
<dt><code>pljava.statement_cache_size</code></dt>
<dd>The number of most-recently-prepared statements PL/Java will keep open.</dd>
<dt><code>pljava.vmoptions</code></dt>
<dd>Any options to be passed to the Java runtime, in the same form as the documented options for the <code>java</code> command (<a class="externalLink" href="https://docs.oracle.com/javase/8/docs/technotes/tools/windows/java.html">windows</a>, <a class="externalLink" href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html">Unix family</a>). The string is split on whitespace unless found between single or double quotes. A backslash treats the following character literally, but the backslash itself remains in the string, so not all values can be expressed with these rules. If the server encoding is not <code>UTF8</code>, only ASCII characters should be used in <code>pljava.vmoptions</code>. The exact quoting and encoding rules for this variable may be adjusted in a future PL/Java version.
<p>Some important settings can be made here, and are described on the <a href="../install/vmoptions.html">VM options page</a>.</p></dd>
</dl>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2003&#x2013;2023<a href="http://tada.se/eng/">Tada AB</a>.
.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
