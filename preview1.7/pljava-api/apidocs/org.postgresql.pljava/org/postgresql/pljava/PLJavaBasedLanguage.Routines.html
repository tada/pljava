<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) on Sat Apr 05 22:30:27 EDT 2025 -->
<title>PLJavaBasedLanguage.Routines (PL/Java API 1.7-SNAPSHOT)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2025-04-05">
<meta name="description" content="declaration: module: org.postgresql.pljava, package: org.postgresql.pljava, interface: PLJavaBasedLanguage, interface: Routines">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../module-summary.html">Module</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/PLJavaBasedLanguage.Routines.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li><a href="#nested-class-summary">Nested</a></li>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="module-label-in-type">Module</span>&nbsp;<a href="../../../module-summary.html">org.postgresql.pljava</a></div>
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.postgresql.pljava</a></div>
<h1 title="Interface PLJavaBasedLanguage.Routines" class="title">Interface PLJavaBasedLanguage.Routines</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Superinterfaces:</dt>
<dd><code><a href="PLJavaBasedLanguage.html" title="interface in org.postgresql.pljava">PLJavaBasedLanguage</a></code></dd>
</dl>
<dl class="notes">
<dt>Enclosing interface:</dt>
<dd><code><a href="PLJavaBasedLanguage.html" title="interface in org.postgresql.pljava">PLJavaBasedLanguage</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public static interface </span><span class="element-name type-name-label">PLJavaBasedLanguage.Routines</span><span class="extends-implements">
extends <a href="PLJavaBasedLanguage.html" title="interface in org.postgresql.pljava">PLJavaBasedLanguage</a></span></div>
<div class="block">To be implemented by a language that supports routines (that is,
 functions and/or procedures).
<p>
 Whether a routine is a function or procedure can be determined at
 validation time (<code>subject.</code><a href="model/RegProcedure.html#kind()"><code>kind()</code></a> in
 <a href="#essentialChecks(org.postgresql.pljava.model.RegProcedure,boolean)"><code>essentialChecks</code></a> or
 <a href="#additionalChecks(org.postgresql.pljava.model.RegProcedure,boolean)"><code>additionalChecks</code></a>) or at
 <a href="#prepare(org.postgresql.pljava.model.RegProcedure)"><code>prepare</code></a> time
 ((<code>target.</code><a href="model/RegProcedure.html#kind()"><code>kind()</code></a>).
 A procedure can also be distinguished from a function in that,
 at <a href="PLJavaBasedLanguage.Routine.html#call(org.postgresql.pljava.model.RegProcedure.Call)"><code>Routine.call(fcinfo)</code></a> time, if a procedure is
 being called, <code>fcinfo.</code><a href="model/RegProcedure.Call.html#context()"><code>context()</code></a> returns
 an instance of <a href="model/RegProcedure.Call.Context.CallContext.html" title="interface in org.postgresql.pljava.model"><code>CallContext</code></a>.
<h2 id="transaction-control-heading">Transaction control</h2>
<p>
 A function is always called within an existing transaction; while it may
 use subtransactions / savepoints, it can never commit, roll back, or
 start a new top-level transaction.
<p>
 A procedure is allowed to start, commit, and roll back top-level
 transactions, provided it was not called inside an existing explicit
 transation. That condition can be checked by consulting
 <a href="model/RegProcedure.Call.Context.CallContext.html#atomic()"><code>CallContext.atomic()</code></a> when
 <code>fcinfo.context()</code> returns an instance of <code>CallContext</code>.
 When <code>atomic()</code> returns <code>true</code>, transaction control is not
 allowed. (If <code>fcinfo.context()</code> returns anything other than an
 instance of <code>CallContext</code>, this is not a procedure call, and
 transaction control is never allowed.)
<p>
 A handler may use this information to impose its own (for example,
 compile-time) limits on a routine's access to transaction-control
 operations. Any use of SPI by the routine will be appropriately limited
 with no need for attention from the handler, as PL/Java propagates the
 atomic/nonatomic flag to SPI always.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="inherited-list">
<h2 id="nested-classes-inherited-from-class-org.postgresql.pljava.PLJavaBasedLanguage">Nested classes/interfaces inherited from interface&nbsp;org.postgresql.pljava.<a href="PLJavaBasedLanguage.html" title="interface in org.postgresql.pljava">PLJavaBasedLanguage</a></h2>
<code><a href="PLJavaBasedLanguage.InlineBlocks.html" title="interface in org.postgresql.pljava">PLJavaBasedLanguage.InlineBlocks</a>, <a href="PLJavaBasedLanguage.Routine.html" title="interface in org.postgresql.pljava">PLJavaBasedLanguage.Routine</a>, <a href="PLJavaBasedLanguage.Routines.html" title="interface in org.postgresql.pljava">PLJavaBasedLanguage.Routines</a>, <a href="PLJavaBasedLanguage.Template.html" title="interface in org.postgresql.pljava">PLJavaBasedLanguage.Template</a>, <a href="PLJavaBasedLanguage.TriggerFunction.html" title="interface in org.postgresql.pljava">PLJavaBasedLanguage.TriggerFunction</a>, <a href="PLJavaBasedLanguage.Triggers.html" title="interface in org.postgresql.pljava">PLJavaBasedLanguage.Triggers</a>, <a href="PLJavaBasedLanguage.TriggerTemplate.html" title="interface in org.postgresql.pljava">PLJavaBasedLanguage.TriggerTemplate</a></code></div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button><button id="method-summary-table-tab5" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab5', 3)" class="table-tab">Default Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code>default void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code><a href="#additionalChecks(org.postgresql.pljava.model.RegProcedure,boolean)" class="member-name-link">additionalChecks</a><wbr>(<a href="model/RegProcedure.html" title="interface in org.postgresql.pljava.model">RegProcedure</a>&lt;<a href="model/ProceduralLanguage.PLJavaBased.html" title="interface in org.postgresql.pljava.model">ProceduralLanguage.PLJavaBased</a>&gt;&nbsp;subject,
 boolean&nbsp;checkBody)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5">
<div class="block">Performs additional validation checks on a proposed PL/Java-based
 routine.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code>default void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5"><code><a href="#essentialChecks(org.postgresql.pljava.model.RegProcedure,boolean)" class="member-name-link">essentialChecks</a><wbr>(<a href="model/RegProcedure.html" title="interface in org.postgresql.pljava.model">RegProcedure</a>&lt;<a href="model/ProceduralLanguage.PLJavaBased.html" title="interface in org.postgresql.pljava.model">ProceduralLanguage.PLJavaBased</a>&gt;&nbsp;subject,
 boolean&nbsp;checkBody)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab5">
<div class="block">Performs the essential validation checks on a proposed
 PL/Java-based routine.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="PLJavaBasedLanguage.Template.html" title="interface in org.postgresql.pljava">PLJavaBasedLanguage.Template</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#prepare(org.postgresql.pljava.model.RegProcedure)" class="member-name-link">prepare</a><wbr>(<a href="model/RegProcedure.html" title="interface in org.postgresql.pljava.model">RegProcedure</a>&lt;<a href="model/ProceduralLanguage.PLJavaBased.html" title="interface in org.postgresql.pljava.model">ProceduralLanguage.PLJavaBased</a>&gt;&nbsp;target)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Prepares a template for a call of the routine <var>target</var>.</div>
</div>
</div>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="essentialChecks(org.postgresql.pljava.model.RegProcedure,boolean)">
<h3>essentialChecks</h3>
<div class="member-signature"><span class="modifiers">default</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">essentialChecks</span><wbr><span class="parameters">(<a href="model/RegProcedure.html" title="interface in org.postgresql.pljava.model">RegProcedure</a>&lt;<a href="model/ProceduralLanguage.PLJavaBased.html" title="interface in org.postgresql.pljava.model">ProceduralLanguage.PLJavaBased</a>&gt;&nbsp;subject,
 boolean&nbsp;checkBody)</span>
                      throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></span></div>
<div class="block">Performs the essential validation checks on a proposed
 PL/Java-based routine.
<p>
 This method should check (when <var>checkBody</var> is true) all the
 essential conditions that <a href="#prepare(org.postgresql.pljava.model.RegProcedure)"><code>prepare</code></a> will assume have
 been checked. Because there is no guarantee that validation at
 routine-creation time always occurred, PL/Java's dispatcher will call
 this method not only at validation time, but also just before
 <code>prepare</code> is first called at run time (always passing true for
 <var>checkBody</var> in that case).
<p>
 This method should throw an informative exception for any check that
 fails, otherwise returning normally. Unless there is a more-specific
 choice, <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLSyntaxErrorException.html" title="class or interface in java.sql" class="external-link"><code>SQLSyntaxErrorException</code></a> with <code>SQLState</code>
 <code>42P13</code> corresponds to PostgreSQL's
 <code>invalid_function_definition</code>.
<p>
 Checks that are helpful at routine-creation time, but not essential
 to correctness of <code>prepare</code>, can be made in
 <a href="#additionalChecks(org.postgresql.pljava.model.RegProcedure,boolean)"><code>additionalChecks</code></a>.
<p>
 If <var>checkBody</var> is false, less-thorough checks may be
 needed. The details are left to the language implementation;
 in general, basic checks of syntax, matching parameter counts, and
 so on are ok, while checks that load or compile user code or depend
 on other database state may be better avoided. The validator may be
 invoked with <var>checkBody</var> false at times when not all
 expected state may be in place, such as during <code>pg_restore</code>
 or <code>pg_upgrade</code>.
<p>
 This method is invoked with <var>checkBody</var> false only if the
 JVM has been started and PL/Java has already loaded and instantiated
 the implementing class, or succeeds in doing so. If not, and
 <var>checkBody</var> is false, PL/Java simply treats the validation
 as successful.
<p>
 This default implementation checks nothing.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="additionalChecks(org.postgresql.pljava.model.RegProcedure,boolean)">
<h3>additionalChecks</h3>
<div class="member-signature"><span class="modifiers">default</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">additionalChecks</span><wbr><span class="parameters">(<a href="model/RegProcedure.html" title="interface in org.postgresql.pljava.model">RegProcedure</a>&lt;<a href="model/ProceduralLanguage.PLJavaBased.html" title="interface in org.postgresql.pljava.model">ProceduralLanguage.PLJavaBased</a>&gt;&nbsp;subject,
 boolean&nbsp;checkBody)</span>
                       throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></span></div>
<div class="block">Performs additional validation checks on a proposed PL/Java-based
 routine.
<p>
 This method should be used for checks that may give helpful feedback
 at routine-creation time, but can be skipped at run time because the
 correct behavior of <a href="#prepare(org.postgresql.pljava.model.RegProcedure)"><code>prepare</code></a> does not depend on them.
 PL/Java calls this method only at routine-creation time, just after
 <a href="#essentialChecks(org.postgresql.pljava.model.RegProcedure,boolean)"><code>essentialChecks</code></a> has completed normally.
<p>
 This method should throw an informative exception for any check that
 fails, otherwise returning normally. Unless there is a more-specific
 choice, <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLSyntaxErrorException.html" title="class or interface in java.sql" class="external-link"><code>SQLSyntaxErrorException</code></a> with <code>SQLState</code>
 <code>42P13</code> corresponds to PostgreSQL's
 <code>invalid_function_definition</code>.
<p>
 Checks of conditions essential to correctness of <code>prepare</code>
 must be made in <code>essentialChecks</code>.
<p>
 If <var>checkBody</var> is false, less-thorough checks may be
 needed. The details are left to the language implementation;
 in general, basic checks of syntax, matching parameter counts, and
 so on are ok, while checks that load or compile user code or depend
 on other database state may be better avoided. The validator may be
 invoked with <var>checkBody</var> false at times when not all
 expected state may be in place, such as during <code>pg_restore</code>
 or <code>pg_upgrade</code>.
<p>
 This default implementation checks nothing.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="prepare(org.postgresql.pljava.model.RegProcedure)">
<h3>prepare</h3>
<div class="member-signature"><span class="return-type"><a href="PLJavaBasedLanguage.Template.html" title="interface in org.postgresql.pljava">PLJavaBasedLanguage.Template</a></span>&nbsp;<span class="element-name">prepare</span><wbr><span class="parameters">(<a href="model/RegProcedure.html" title="interface in org.postgresql.pljava.model">RegProcedure</a>&lt;<a href="model/ProceduralLanguage.PLJavaBased.html" title="interface in org.postgresql.pljava.model">ProceduralLanguage.PLJavaBased</a>&gt;&nbsp;target)</span>
                              throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></span></div>
<div class="block">Prepares a template for a call of the routine <var>target</var>.
<p>
 The information available at this stage comes from the system
 catalogs, reflecting the static declaration of the target routine.
 The methods of <var>target</var> can be used to examine that
 catalog information; the <a href="model/RegProcedure.html#memo()"><code>memo</code></a> method
 retrieves a PL/Java-specific <a href="model/ProceduralLanguage.PLJavaBased.html" title="interface in org.postgresql.pljava.model"><code>memo</code></a> with some
 derived information, including tuple descriptors for the inputs and
 outputs. (All routines, including those treated by PostgreSQL as
 returning a scalar result, are presented to a PL/Java handler with
 the inputs and outputs represented by <a href="model/TupleTableSlot.html" title="interface in org.postgresql.pljava.model"><code>TupleTableSlot</code></a>.)
 The tuple descriptors seen at this stage may include attributes with
 polymorphic types, not resolvable to specific types until the
 <code>Template</code> instance this method returns is later applied at
 an actual call site.
<p>
 This method should return a <a href="PLJavaBasedLanguage.Template.html" title="interface in org.postgresql.pljava"><code>Template</code></a>, which may
 encapsulate any useful precomputed values based on the catalog
 information this method consulted.
<p>
 The template, when its <a href="PLJavaBasedLanguage.Template.html#specialize(org.postgresql.pljava.model.RegProcedure.Lookup)"><code>specialize</code></a> method
 is invoked on an actual <a href="model/RegProcedure.Lookup.html" title="interface in org.postgresql.pljava.model"><code>Lookup</code></a> instance, should return
 a <a href="PLJavaBasedLanguage.Routine.html" title="interface in org.postgresql.pljava"><code>Routine</code></a> able to apply the target function's logic
 when invoked any number of times on <a href="model/RegProcedure.Call.html" title="interface in org.postgresql.pljava.model"><code>Call</code></a> instances
 associated with the same <code>Lookup</code>.
<p>
 When there is no polymorphic or variadic-"any" funny business in
 <var>target</var>'s declaration, this method may return a
 <code>Template</code> that ignores its argument and always returns the
 same <code>Routine</code>. It could even do so in all cases, if
 implementing a language where those dynamic details are left to user
 code.</div>
<dl class="notes">
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html" title="class or interface in java.sql" class="external-link">SQLException</a></code></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2003&#x2013;2025<a href='http://tada.se/eng/'>Tada AB</a></small></p>
</footer>
</div>
</div>
</body>
</html>
