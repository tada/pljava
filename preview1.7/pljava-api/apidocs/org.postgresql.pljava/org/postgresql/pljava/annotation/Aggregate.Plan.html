<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) on Thu Mar 27 11:27:19 EDT 2025 -->
<title>Aggregate.Plan (PL/Java API 1.7-SNAPSHOT)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2025-03-27">
<meta name="description" content="declaration: module: org.postgresql.pljava, package: org.postgresql.pljava.annotation, annotation type: Aggregate, annotation type: Plan">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../module-summary.html">Module</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/Aggregate.Plan.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Field</li>
<li>Required</li>
<li><a href="#annotation-interface-optional-element-summary">Optional</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li><a href="#annotation-interface-element-detail">Element</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Required&nbsp;|&nbsp;</li>
<li><a href="#annotation-interface-optional-element-summary">Optional</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#annotation-interface-element-detail">Element</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="module-label-in-type">Module</span>&nbsp;<a href="../../../../module-summary.html">org.postgresql.pljava</a></div>
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.postgresql.pljava.annotation</a></div>
<h1 title="Annotation Interface Aggregate.Plan" class="title">Annotation Interface Aggregate.Plan</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>Enclosing class:</dt>
<dd><code><a href="Aggregate.html" title="annotation interface in org.postgresql.pljava.annotation">Aggregate</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="annotations"><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/annotation/Documented.html" title="class or interface in java.lang.annotation" class="external-link">@Documented</a>
<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/annotation/Target.html" title="class or interface in java.lang.annotation" class="external-link">@Target</a>({})
<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/annotation/Retention.html" title="class or interface in java.lang.annotation" class="external-link">@Retention</a>(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/annotation/RetentionPolicy.html#CLASS" title="class or interface in java.lang.annotation" class="external-link">CLASS</a>)
</span><span class="modifiers">public static @interface </span><span class="element-name type-name-label">Aggregate.Plan</span></div>
<div class="block">Specifies one "plan" for evaluating the aggregate; one must always be
 specified (as <code>plan</code>), and a second may be specified (as
 <code>movingPlan</code>).
<p>
 A plan must specify a data type <code>stateType</code> to hold the
 accumulating state, optionally an estimate of its expected size in bytes,
 and optionally its initial contents. The plan also specifies up to four
 functions <code>accumulate</code>, <code>combine</code>, <code>finish</code>, and
 <code>remove</code>. Only <code>accumulate</code> is always required;
 <code>remove</code> is required in a <code>movingPlan</code>, and otherwise not
 allowed.
<p>
 Each of the four functions may be specified as a single string "name",
 which will be leniently parsed as an optionally schema-qualified name,
 or as two strings <code>{"schema","local"}</code> with the schema made
 explicit. The two-string form with <code>""</code> as the schema represents
 an explicitly non-schema-qualified name.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== ANNOTATION INTERFACE OPTIONAL MEMBER SUMMARY =========== -->
<li>
<section class="member-summary" id="annotation-interface-optional-element-summary">
<h2>Optional Element Summary</h2>
<div class="caption"><span>Optional Elements</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Optional Element</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</code></div>
<div class="col-second even-row-color"><code><a href="#accumulate()" class="member-name-link">accumulate</a></code></div>
<div class="col-last even-row-color">
<div class="block">Name of the function that will be called for each row being
 aggregated.</div>
</div>
<div class="col-first odd-row-color"><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</code></div>
<div class="col-second odd-row-color"><code><a href="#combine()" class="member-name-link">combine</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Name of an optional function to combine two instances of the state
 type.</div>
</div>
<div class="col-first even-row-color"><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</code></div>
<div class="col-second even-row-color"><code><a href="#deserialize()" class="member-name-link">deserialize</a></code></div>
<div class="col-last even-row-color">
<div class="block">Name of a deserializing function ((<code>bytea</code>, <code>internal</code>)
 to <code>internal</code>), usable only if a <code>serialize</code> function is
 also specified.</div>
</div>
<div class="col-first odd-row-color"><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</code></div>
<div class="col-second odd-row-color"><code><a href="#finish()" class="member-name-link">finish</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Name of an optional function to produce the aggregate's result from
 the final value of the state; without this function, the aggregate's
 result type is the state type, and the result is simply the final
 value of the state.</div>
</div>
<div class="col-first even-row-color"><code><a href="Aggregate.FinishEffect.html" title="enum class in org.postgresql.pljava.annotation">Aggregate.FinishEffect</a></code></div>
<div class="col-second even-row-color"><code><a href="#finishEffect()" class="member-name-link">finishEffect</a></code></div>
<div class="col-last even-row-color">
<div class="block">The effect of the <code>finish</code> function in this <code>Plan</code>.</div>
</div>
<div class="col-first odd-row-color"><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color"><code><a href="#initialState()" class="member-name-link">initialState</a></code></div>
<div class="col-last odd-row-color">
<div class="block">An optional initial value for the state (which will otherwise be
 initially null).</div>
</div>
<div class="col-first even-row-color"><code>boolean</code></div>
<div class="col-second even-row-color"><code><a href="#polymorphic()" class="member-name-link">polymorphic</a></code></div>
<div class="col-last even-row-color">
<div class="block">Whether the argument list for <code>finish</code> should be extended with
 slots corresponding to the aggregated <code>arguments</code>, all nulls at
 runtime but with their resolved runtime types.</div>
</div>
<div class="col-first odd-row-color"><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</code></div>
<div class="col-second odd-row-color"><code><a href="#remove()" class="member-name-link">remove</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Name of an optional function that can reverse the effect on the state
 of a row previously passed to <code>accumulate</code>.</div>
</div>
<div class="col-first even-row-color"><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</code></div>
<div class="col-second even-row-color"><code><a href="#serialize()" class="member-name-link">serialize</a></code></div>
<div class="col-last even-row-color">
<div class="block">Name of a serializing function (<code>internal</code> to <code>bytea</code>),
 usable only if a <a href="#combine()"><code>combine</code></a> function is specified and
 the aggregate's state type is <code>internal</code>.</div>
</div>
<div class="col-first odd-row-color"><code>int</code></div>
<div class="col-second odd-row-color"><code><a href="#stateSize()" class="member-name-link">stateSize</a></code></div>
<div class="col-last odd-row-color">
<div class="block">An optional estimate of the size in bytes that the state may grow
 to occupy.</div>
</div>
<div class="col-first even-row-color"><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color"><code><a href="#stateType()" class="member-name-link">stateType</a></code></div>
<div class="col-last even-row-color">
<div class="block">The data type to be used to hold the accumulating state.</div>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details" id="annotation-interface-element-detail">
<ul class="details-list">
<!-- ============ ANNOTATION INTERFACE MEMBER DETAIL =========== -->
<li>
<section class="member-details">
<h2>Element Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="stateType()">
<h3>stateType</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">stateType</span></div>
<div class="block">The data type to be used to hold the accumulating state.
<p>
 This will be the first argument type for all of the support functions
 except <code>deserialize</code> (both argument types for <code>combine</code>)
 and also, if there is no <code>finish</code> function, the result type
 of the aggregate.</div>
<dl class="notes">
<dt>Default:</dt>
<dd><code>""</code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="stateSize()">
<h3>stateSize</h3>
<div class="member-signature"><span class="return-type">int</span>&nbsp;<span class="element-name">stateSize</span></div>
<div class="block">An optional estimate of the size in bytes that the state may grow
 to occupy.</div>
<dl class="notes">
<dt>Default:</dt>
<dd><code>0</code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="initialState()">
<h3>initialState</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">initialState</span></div>
<div class="block">An optional initial value for the state (which will otherwise be
 initially null).
<p>
 Must be a string the state type's text-input conversion would accept.
<p>
 Omitting the initial value only works if the <code>accumulate</code>
 function is <code>onNullInput=CALLED</code>, or if the aggregate's first
 argument type is the same as the state type.</div>
<dl class="notes">
<dt>Default:</dt>
<dd><code>""</code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="accumulate()">
<h3>accumulate</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</span>&nbsp;<span class="element-name">accumulate</span></div>
<div class="block">Name of the function that will be called for each row being
 aggregated.
<p>
 The function named here must have an argument list that starts with
 one argument of the state type, followed by all of this aggregate's
 <code>arguments</code>. It does not receive the <code>directArguments</code>,
 if any.</div>
<dl class="notes">
<dt>Default:</dt>
<dd><code>{}</code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="combine()">
<h3>combine</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</span>&nbsp;<span class="element-name">combine</span></div>
<div class="block">Name of an optional function to combine two instances of the state
 type.
<p>
 The function named here should be one that has two arguments, both
 of the state type, and returns the state type.</div>
<dl class="notes">
<dt>Default:</dt>
<dd><code>{}</code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="finish()">
<h3>finish</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</span>&nbsp;<span class="element-name">finish</span></div>
<div class="block">Name of an optional function to produce the aggregate's result from
 the final value of the state; without this function, the aggregate's
 result type is the state type, and the result is simply the final
 value of the state.
<p>
 When this function is specified, its result type determines the
 result type of the aggregate. Its argument list signature is a single
 argument of the state type, followed by all the
 <code>directArguments</code> if any, followed (only if <code>polymorphic</code>
 is true) by <code>arguments.length</code> additional arguments for which
 nulls will be passed at runtime but with their resolved runtime
 types.</div>
<dl class="notes">
<dt>Default:</dt>
<dd><code>{}</code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="remove()">
<h3>remove</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</span>&nbsp;<span class="element-name">remove</span></div>
<div class="block">Name of an optional function that can reverse the effect on the state
 of a row previously passed to <code>accumulate</code>.
<p>
 The function named here should have the same argument list signature
 as the <code>accumulate</code> function.
<p>
 Required in a <code>movingPlan</code>; not allowed otherwise.</div>
<dl class="notes">
<dt>Default:</dt>
<dd><code>{}</code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="polymorphic()">
<h3>polymorphic</h3>
<div class="member-signature"><span class="return-type">boolean</span>&nbsp;<span class="element-name">polymorphic</span></div>
<div class="block">Whether the argument list for <code>finish</code> should be extended with
 slots corresponding to the aggregated <code>arguments</code>, all nulls at
 runtime but with their resolved runtime types.</div>
<dl class="notes">
<dt>Default:</dt>
<dd><code>false</code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="finishEffect()">
<h3>finishEffect</h3>
<div class="member-signature"><span class="return-type"><a href="Aggregate.FinishEffect.html" title="enum class in org.postgresql.pljava.annotation">Aggregate.FinishEffect</a></span>&nbsp;<span class="element-name">finishEffect</span></div>
<div class="block">The effect of the <code>finish</code> function in this <code>Plan</code>.
<p>
 If <code>READ_ONLY</code>, PostgreSQL can continue updating the same
 state with additional rows, and call the finisher again for updated
 results.
<p>
 If <code>SHAREABLE</code>, the state cannot be further updated after a
 finisher call, but finishers for other aggregates that use the same
 state representation (and are also <code>SHAREABLE</code>) can be called
 to produce the results for those aggregates. An example could be the
 several linear-regression-related aggregates, all of which can work
 from a state that contains the count of values, sum of values, and
 sum of squares.
<p>
 If <code>READ_WRITE</code>, no further use can be made of the state after
 the finisher has run.
<p>
 Leaving this to default is not exactly equivalent to specifying the
 default value shown here. If left to default, it will be left
 unspecified in the generated <code>CREATE AGGREGATE</code>, and PostgreSQL
 will apply its default, which is <code>READ_ONLY</code> in the case of an
 ordinary aggregate, but <code>READ_WRITE</code> for an ordered-set or
 hypothetical-set aggregate.</div>
<dl class="notes">
<dt>Default:</dt>
<dd><code>READ_ONLY</code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="serialize()">
<h3>serialize</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</span>&nbsp;<span class="element-name">serialize</span></div>
<div class="block">Name of a serializing function (<code>internal</code> to <code>bytea</code>),
 usable only if a <a href="#combine()"><code>combine</code></a> function is specified and
 the aggregate's state type is <code>internal</code>.
<p>
 Not allowed in a <code>movingPlan</code>. Not allowed without
 <code>deserialize</code>.</div>
<dl class="notes">
<dt>Default:</dt>
<dd><code>{}</code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="deserialize()">
<h3>deserialize</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</span>&nbsp;<span class="element-name">deserialize</span></div>
<div class="block">Name of a deserializing function ((<code>bytea</code>, <code>internal</code>)
 to <code>internal</code>), usable only if a <code>serialize</code> function is
 also specified.
<p>
 Not allowed in a <code>movingPlan</code>.</div>
<dl class="notes">
<dt>Default:</dt>
<dd><code>{}</code></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2003&#x2013;2025<a href='http://tada.se/eng/'>Tada AB</a></small></p>
</footer>
</div>
</div>
</body>
</html>
