<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (12.0.2) on Tue Feb 01 12:27:46 EST 2022 -->
<title>Money (PL/Java API 1.7-SNAPSHOT)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2022-02-01">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../../../../../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="Money (PL/Java API 1.7-SNAPSHOT)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../module-summary.html">Module</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Money.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="moduleLabelInType">Module</span>&nbsp;<a href="../../../../module-summary.html">org.postgresql.pljava</a></div>
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.postgresql.pljava.adt</a></div>
<h2 title="Interface Money" class="title">Interface Money&lt;T&gt;</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Superinterfaces:</dt>
<dd><code><a href="../Adapter.Contract.html" title="interface in org.postgresql.pljava">Adapter.Contract</a>&lt;T&gt;</code>, <code><a href="../Adapter.Contract.Scalar.html" title="interface in org.postgresql.pljava">Adapter.Contract.Scalar</a>&lt;T&gt;</code></dd>
</dl>
<dl>
<dt>Functional Interface:</dt>
<dd>This is a functional interface and can therefore be used as the assignment target for a lambda expression or method reference.</dd>
</dl>
<hr>
<pre><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/FunctionalInterface.html?is-external=true" title="class or interface in java.lang" class="externalLink">@FunctionalInterface</a>
public interface <span class="typeNameLabel">Money&lt;T&gt;</span>
extends <a href="../Adapter.Contract.Scalar.html" title="interface in org.postgresql.pljava">Adapter.Contract.Scalar</a>&lt;T&gt;</pre>
<div class="block">The <code>MONEY</code> type's PostgreSQL semantics: an integer value, whose
 scaling, display format, and currency are all determined by a
 user-settable configuration setting.
<p>
 This type is a strange duck in PostgreSQL. It is stored
 as a (64 bit) integer, and must have a scaling applied on input and
 output to the appropriate number of decimal places.
<p>
 The appropriate scaling, the symbols for decimal point and grouping
 separators, how the sign is shown, <em>and even what currency it
 represents</em> and the currency symbol to use, are all determined
 from the locale specified by the <code>lc_monetary</code> configuration
 setting, which can be changed within any session with no special
 privilege at any time. That may make <code>MONEY</code> the only data type
 in PostgreSQL where a person can use a single <code>SET</code> command to
 instantly change what an entire table of data means.
<p>
 For example, this little catalog of products:
<pre>
 =&gt; SELECT * FROM products;
  product |       price
 ---------+--------------------
  widget  |             $19.00
  tokamak | $19,000,000,000.00
</pre>
<p>
 can be instantly marked down by about 12 percent (at the exchange
 rates looked up at this writing):
<pre>
 =&gt; SET lc_monetary TO 'ja_JP';
 SET
 =&gt; SELECT * FROM products;
  product |        price
 ---------+---------------------
  widget  |             ￥1,900
  tokamak | ￥1,900,000,000,000
</pre>
<p>
 or marked up by roughly the same amount:
<pre>
 =&gt; SET lc_monetary TO 'de_DE@euro';
 SET
 =&gt; SELECT * FROM products;
  product |        price
 ---------+---------------------
  widget  |             19,00 €
  tokamak | 19.000.000.000,00 €
</pre>
<p>
 or marked up even further (as of this writing, 26%):
<pre>
 =&gt; SET lc_monetary TO 'en_GB';
 SET
 =&gt; SELECT * FROM products;
  product |       price
 ---------+--------------------
  widget  |             £19.00
  tokamak | £19,000,000,000.00
</pre>
<p>
 <b>Obtaining the locale information in Java</b>
<p>
 Before the integer value provided here can be correctly scaled or
 interpreted, the locale-dependent information must be obtained.
 In Java, that can be done in six steps:
<ol>
<li>Obtain the string value of PostgreSQL's <code>lc_monetary</code>
 configuration setting.
<li>Let's not talk about step 2 just yet.
<li>Obtain a <code>Locale</code> object by passing the BCP 47 tag to
 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/util/Locale.html?is-external=true#forLanguageTag(java.lang.String)" title="class or interface in java.util" class="externalLink"><code>Locale.forLanguageTag</code></a>.
<li>Pass the <code>Locale</code> object to
 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/text/NumberFormat.html?is-external=true#getCurrencyInstance(java.util.Locale)" title="class or interface in java.text" class="externalLink"><code>NumberFormat.getCurrencyInstance</code></a>.
<li>From that, obtain an actual instance of <code>Currency</code> with
 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/text/NumberFormat.html?is-external=true#getCurrency()" title="class or interface in java.text" class="externalLink"><code>NumberFormat.getCurrency</code></a>.
<li>Obtain the correct power of ten for scaling from
 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/util/Currency.html?is-external=true#getDefaultFractionDigits()" title="class or interface in java.util" class="externalLink"><code>Currency.getDefaultFractionDigits</code></a>.
</ol>
<p>
 The <code>NumberFormat</code> obtained in step 4 knows all the appropriate
 formatting details, but will not automatically scale the integer
 value here by the proper power of ten. That must be done explicitly,
 and to avoid compromising the precision objectives of the
 <code>MONEY</code> type, should be done with something like a
 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/math/BigDecimal.html?is-external=true" title="class or interface in java.math" class="externalLink"><code>BigDecimal</code></a>. If <var>fmt</var> was obtained
 in step 4 above and <var>scale</var> is the value from step 6:
<pre>
 BigDecimal bd =
     BigDecimal.valueOf(scaledToInteger).movePointLeft(scale);
 String s = fmt.format(bd);
</pre>
<p>
 would produce the correctly-formatted value, where
 <var>scaledToInteger</var> is the parameter supplied to this interface
 method.
<p>
 If the format is not needed, the scale can be obtained in fewer steps
 by passing the <code>Locale</code> from step 3 directly to
 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/util/Currency.html?is-external=true#getInstance(java.util.Locale)" title="class or interface in java.util" class="externalLink"><code>Currency.getInstance</code></a>.
 That would be enough to build a simple reference implementation for
 this data type that would return a <code>BigDecimal</code> with its point
 moved left by the scale.
<p>
 Now let's talk about step 2.
<p>
 Java's locale support is based on BCP 47, a format for identifiers
 <a href="https://www.rfc-editor.org/info/bcp47">standardized by
 IETF</a> to ensure that they are reliable and specific.
<p>
 The string obtained from the <code>lc_monetary</code> setting in step 1
 above is, most often, a string that makes sense to the underlying
 operating system's C library, using some syntax that predated BCP 47,
 and likely demonstrates all of the problems BCP 47 was created to
 overcome.
<p>
 From a first glance at a few simple examples, it can appear that
 replacing some underscores with hyphens could turn some simple
 OS-library strings into BCP 47 tags, but that is far from the general
 case, which is full of nonobvious rules, special cases, and
 grandfather clauses.
<p>
 A C library, <code>liblangtag</code>, is available to perform exactly that
 mapping, and weighs in at about two and a half megabytes. The library
 might be present on the system where PostgreSQL is running, in which
 case it could be used in step 2, at the cost of a native call.
<p>
 If PostgreSQL was built with ICU, a native method could accomplish
 the same (as nearly as practical) thing by calling
 <code>uloc_canonicalize</code> followed by <code>uloc_toLanguageTag</code>; or,
 if the ICU4J Java library is available,
 <code>ULocale.createCanonical</code>could be used to the same effect.
<p>
 It might be simplest to just use a native call to obtain the
 scaling and other needed details from the underlying operating system
 library.
<p>
 Because of step 2's complexity, PL/Java does not here supply the
 simple reference implementation to <code>BigDecimal</code> proposed above.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<ul class="blockList">
<li class="blockList"><a id="nested.classes.inherited.from.class.org.postgresql.pljava.Adapter.Contract">
<!--   -->
</a>
<h3>Nested classes/interfaces inherited from interface&nbsp;org.postgresql.pljava.<a href="../Adapter.Contract.html" title="interface in org.postgresql.pljava">Adapter.Contract</a></h3>
<code><a href="../Adapter.Contract.Array.html" title="interface in org.postgresql.pljava">Adapter.Contract.Array</a>&lt;<a href="../Adapter.Contract.Array.html" title="type parameter in Adapter.Contract.Array">T</a>,&#8203;<a href="../Adapter.Contract.Array.html" title="type parameter in Adapter.Contract.Array">E</a>,&#8203;<a href="../Adapter.Contract.Array.html" title="type parameter in Adapter.Contract.Array">A</a> extends <a href="../Adapter.html" title="class in org.postgresql.pljava">Adapter</a>&lt;<a href="../Adapter.Contract.Array.html" title="type parameter in Adapter.Contract.Array">E</a>,&#8203;?&gt;&gt;, <a href="../Adapter.Contract.Scalar.html" title="interface in org.postgresql.pljava">Adapter.Contract.Scalar</a>&lt;<a href="../Adapter.Contract.Scalar.html" title="type parameter in Adapter.Contract.Scalar">T</a>&gt;</code></li>
</ul>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<div class="memberSummary">
<div role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="memberSummary_tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="activeTableTab">All Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t2" class="tableTab" onclick="show(2);">Instance Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t3" class="tableTab" onclick="show(4);">Abstract Methods</button></div>
<div id="memberSummary_tabpanel" role="tabpanel">
<table aria-labelledby="t0">
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor" id="i0">
<td class="colFirst"><code><a href="Money.html" title="type parameter in Money">T</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#construct(long)">construct</a></span>&#8203;(long&nbsp;scaledToInteger)</code></th>
<td class="colLast">
<div class="block">Constructs a representation <var>T</var> from the components
 of the PostgreSQL data type.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="construct(long)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>construct</h4>
<pre class="methodSignature"><a href="Money.html" title="type parameter in Money">T</a>&nbsp;construct&#8203;(long&nbsp;scaledToInteger)</pre>
<div class="block">Constructs a representation <var>T</var> from the components
 of the PostgreSQL data type.
<p>
 It might be necessary to extend this interface with extra parameters
 (or to use the <code>Modifier</code> mechanism) to receive the needed
 scaling and currency details, and require the corresponding
 <code>Adapter</code> (which could no longer be pure Java) to make
 the needed native calls to obtain those.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>scaledToInteger</code> - integer value that must be scaled according
 to the setting of the <var>lc_monetary</var> configuration setting,
 and represents a value in the currency also determined by that
 setting.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../module-summary.html">Module</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Money.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2003&#x2013;2022<a href='http://tada.se/eng/'>Tada AB</a></small></p>
</footer>
</body>
</html>
