<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) on Sun May 25 18:29:40 EDT 2025 -->
<title>Money (PL/Java API 1.7-SNAPSHOT)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2025-05-25">
<meta name="description" content="declaration: module: org.postgresql.pljava, package: org.postgresql.pljava.adt, interface: Money">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../module-summary.html">Module</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/Money.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li><a href="#nested-class-summary">Nested</a></li>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li>Field</li>
<li>Constr</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="module-label-in-type">Module</span>&nbsp;<a href="../../../../module-summary.html">org.postgresql.pljava</a></div>
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.postgresql.pljava.adt</a></div>
<h1 title="Interface Money" class="title">Interface Money&lt;T&gt;</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Superinterfaces:</dt>
<dd><code><a href="../Adapter.Contract.html" title="interface in org.postgresql.pljava">Adapter.Contract</a>&lt;T&gt;</code>, <code><a href="../Adapter.Contract.Scalar.html" title="interface in org.postgresql.pljava">Adapter.Contract.Scalar</a>&lt;T&gt;</code></dd>
</dl>
<dl class="notes">
<dt>Functional Interface:</dt>
<dd>This is a functional interface and can therefore be used as the assignment target for a lambda expression or method reference.</dd>
</dl>
<hr>
<div class="type-signature"><span class="annotations"><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/FunctionalInterface.html" title="class or interface in java.lang" class="external-link">@FunctionalInterface</a>
</span><span class="modifiers">public interface </span><span class="element-name type-name-label">Money&lt;T&gt;</span><span class="extends-implements">
extends <a href="../Adapter.Contract.Scalar.html" title="interface in org.postgresql.pljava">Adapter.Contract.Scalar</a>&lt;T&gt;</span></div>
<div class="block">The <code>MONEY</code> type's PostgreSQL semantics: an integer value, whose
 scaling, display format, and currency are all determined by a
 user-settable configuration setting.
<p>
 This type is a strange duck in PostgreSQL. It is stored
 as a (64 bit) integer, and must have a scaling applied on input and
 output to the appropriate number of decimal places.
<p>
 The appropriate scaling, the symbols for decimal point and grouping
 separators, how the sign is shown, <em>and even what currency it
 represents</em> and the currency symbol to use, are all determined
 from the locale specified by the <code>lc_monetary</code> configuration
 setting, which can be changed within any session with no special
 privilege at any time. That may make <code>MONEY</code> the only data type
 in PostgreSQL where a person can use a single <code>SET</code> command to
 instantly change what an entire table of data means.
<p>
 For example, this little catalog of products:
<pre>
 =&gt; SELECT * FROM products;
  product |       price
 ---------+--------------------
  widget  |             $19.00
  tokamak | $19,000,000,000.00
</pre>
<p>
 can be instantly marked down by about 12 percent (at the exchange
 rates looked up at this writing):
<pre>
 =&gt; SET lc_monetary TO 'ja_JP';
 SET
 =&gt; SELECT * FROM products;
  product |        price
 ---------+---------------------
  widget  |             ￥1,900
  tokamak | ￥1,900,000,000,000
</pre>
<p>
 or marked up by roughly the same amount:
<pre>
 =&gt; SET lc_monetary TO 'de_DE@euro';
 SET
 =&gt; SELECT * FROM products;
  product |        price
 ---------+---------------------
  widget  |             19,00 €
  tokamak | 19.000.000.000,00 €
</pre>
<p>
 or marked up even further (as of this writing, 26%):
<pre>
 =&gt; SET lc_monetary TO 'en_GB';
 SET
 =&gt; SELECT * FROM products;
  product |       price
 ---------+--------------------
  widget  |             £19.00
  tokamak | £19,000,000,000.00
</pre>
<p>
 <b>Obtaining the locale information in Java</b>
<p>
 Before the integer value provided here can be correctly scaled or
 interpreted, the locale-dependent information must be obtained.
 In Java, that can be done in six steps:
<ol>
<li>Obtain the string value of PostgreSQL's <code>lc_monetary</code>
 configuration setting.
<li>Let's not talk about step 2 just yet.
<li>Obtain a <code>Locale</code> object by passing the BCP 47 tag to
 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/util/Locale.html#forLanguageTag(java.lang.String)" title="class or interface in java.util" class="external-link"><code>Locale.forLanguageTag</code></a>.
<li>Pass the <code>Locale</code> object to
 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/text/NumberFormat.html#getCurrencyInstance(java.util.Locale)" title="class or interface in java.text" class="external-link"><code>NumberFormat.getCurrencyInstance</code></a>.
<li>From that, obtain an actual instance of <code>Currency</code> with
 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/text/NumberFormat.html#getCurrency()" title="class or interface in java.text" class="external-link"><code>NumberFormat.getCurrency</code></a>.
<li>Obtain the correct power of ten for scaling from
 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/util/Currency.html#getDefaultFractionDigits()" title="class or interface in java.util" class="external-link"><code>Currency.getDefaultFractionDigits</code></a>.
</ol>
<p>
 The <code>NumberFormat</code> obtained in step 4 knows all the appropriate
 formatting details, but will not automatically scale the integer
 value here by the proper power of ten. That must be done explicitly,
 and to avoid compromising the precision objectives of the
 <code>MONEY</code> type, should be done with something like a
 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/math/BigDecimal.html" title="class or interface in java.math" class="external-link"><code>BigDecimal</code></a>. If <var>fmt</var> was obtained
 in step 4 above and <var>scale</var> is the value from step 6:
<pre>
 BigDecimal bd =
     BigDecimal.valueOf(scaledToInteger).movePointLeft(scale);
 String s = fmt.format(bd);
</pre>
<p>
 would produce the correctly-formatted value, where
 <var>scaledToInteger</var> is the parameter supplied to this interface
 method.
<p>
 If the format is not needed, the scale can be obtained in fewer steps
 by passing the <code>Locale</code> from step 3 directly to
 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/util/Currency.html#getInstance(java.util.Locale)" title="class or interface in java.util" class="external-link"><code>Currency.getInstance</code></a>.
 That would be enough to build a simple reference implementation for
 this data type that would return a <code>BigDecimal</code> with its point
 moved left by the scale.
<p>
 Now let's talk about step 2.
<p>
 Java's locale support is based on BCP 47, a format for identifiers
 <a href="https://www.rfc-editor.org/info/bcp47">standardized by
 IETF</a> to ensure that they are reliable and specific.
<p>
 The string obtained from the <code>lc_monetary</code> setting in step 1
 above is, most often, a string that makes sense to the underlying
 operating system's C library, using some syntax that predated BCP 47,
 and likely demonstrates all of the problems BCP 47 was created to
 overcome.
<p>
 From a first glance at a few simple examples, it can appear that
 replacing some underscores with hyphens could turn some simple
 OS-library strings into BCP 47 tags, but that is far from the general
 case, which is full of nonobvious rules, special cases, and
 grandfather clauses.
<p>
 A C library, <code>liblangtag</code>, is available to perform exactly that
 mapping, and weighs in at about two and a half megabytes. The library
 might be present on the system where PostgreSQL is running, in which
 case it could be used in step 2, at the cost of a native call.
<p>
 If PostgreSQL was built with ICU, a native method could accomplish
 the same (as nearly as practical) thing by calling
 <code>uloc_canonicalize</code> followed by <code>uloc_toLanguageTag</code>; or,
 if the ICU4J Java library is available,
 <code>ULocale.createCanonical</code>could be used to the same effect.
<p>
 It might be simplest to just use a native call to obtain the
 scaling and other needed details from the underlying operating system
 library.
<p>
 Because of step 2's complexity, PL/Java does not here supply the
 simple reference implementation to <code>BigDecimal</code> proposed above.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="inherited-list">
<h2 id="nested-classes-inherited-from-class-org.postgresql.pljava.Adapter.Contract">Nested classes/interfaces inherited from interface&nbsp;org.postgresql.pljava.<a href="../Adapter.Contract.html" title="interface in org.postgresql.pljava">Adapter.Contract</a></h2>
<code><a href="../Adapter.Contract.Array.html" title="interface in org.postgresql.pljava">Adapter.Contract.Array</a>&lt;<a href="../Adapter.Contract.Array.html" title="type parameter in Adapter.Contract.Array">T</a>,<wbr><a href="../Adapter.Contract.Array.html" title="type parameter in Adapter.Contract.Array">E</a>,<wbr><a href="../Adapter.Contract.Array.html" title="type parameter in Adapter.Contract.Array">A</a> extends <a href="../Adapter.html" title="class in org.postgresql.pljava">Adapter</a>&lt;<a href="../Adapter.Contract.Array.html" title="type parameter in Adapter.Contract.Array">E</a>,<wbr>?&gt;&gt;, <a href="../Adapter.Contract.Scalar.html" title="interface in org.postgresql.pljava">Adapter.Contract.Scalar</a>&lt;<a href="../Adapter.Contract.Scalar.html" title="type parameter in Adapter.Contract.Scalar">T</a>&gt;</code></div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="Money.html" title="type parameter in Money">T</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#construct(long)" class="member-name-link">construct</a><wbr>(long&nbsp;scaledToInteger)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Constructs a representation <var>T</var> from the components
 of the PostgreSQL data type.</div>
</div>
</div>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="construct(long)">
<h3>construct</h3>
<div class="member-signature"><span class="return-type"><a href="Money.html" title="type parameter in Money">T</a></span>&nbsp;<span class="element-name">construct</span><wbr><span class="parameters">(long&nbsp;scaledToInteger)</span></div>
<div class="block">Constructs a representation <var>T</var> from the components
 of the PostgreSQL data type.
<p>
 It might be necessary to extend this interface with extra parameters
 (or to use the <code>Modifier</code> mechanism) to receive the needed
 scaling and currency details, and require the corresponding
 <code>Adapter</code> (which could no longer be pure Java) to make
 the needed native calls to obtain those.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>scaledToInteger</code> - integer value that must be scaled according
 to the setting of the <var>lc_monetary</var> configuration setting,
 and represents a value in the currency also determined by that
 setting.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2003&#x2013;2025<a href='http://tada.se/eng/'>Tada AB</a></small></p>
</footer>
</div>
</div>
</body>
</html>
