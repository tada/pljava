<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (12.0.2) on Sat Oct 19 20:26:48 EDT 2024 -->
<title>S9 (PL/Java examples 1.6.8)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2024-10-19">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../jquery/jquery-3.3.1.js"></script>
<script type="text/javascript" src="../../../../../jquery/jquery-migrate-3.0.1.js"></script>
<script type="text/javascript" src="../../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="S9 (PL/Java examples 1.6.8)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10,"i2":9,"i3":9,"i4":9,"i5":9,"i6":9,"i7":9,"i8":9,"i9":9,"i10":9,"i11":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/S9.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.postgresql.pljava.example.saxon</a></div>
<h2 title="Class S9" class="title">Class S9</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.postgresql.pljava.example.saxon.S9</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code>org.postgresql.pljava.ResultSetProvider</code>, <code>org.postgresql.pljava.ResultSetProvider.Large</code></dd>
</dl>
<hr>
<pre>public class <a href="../../../../../src-html/org/postgresql/pljava/example/saxon/S9.html#line.291">S9</a>
extends <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a>
implements org.postgresql.pljava.ResultSetProvider.Large</pre>
<div class="block">Class illustrating use of XQuery with Saxon as the
 implementation, using its native "s9api".
<p>
 Supplies alternative, XML Query-based (as the SQL/XML standard dictates)
 implementation of some of SQL/XML, where the implementation in core
 PostgreSQL is limited to the capabilities of XPath (and XPath 1.0, at that).
<p>
 Without the syntatic sugar built into the core PostgreSQL parser, calls to
 a function in this class can look a bit more verbose in SQL, but reflect a
 straightforward rewriting from the standard syntax. For example, suppose
 there is a table <code>catalog_as_xml</code> with a single row whose <code>x</code>
 column is a (respectably sized) XML document recording the stuff in
 <code>pg_catalog</code>. It could be created like this:
<pre>
 CREATE TABLE catalog_as_xml(x) AS
   SELECT schema_to_xml('pg_catalog', false, true, '');
</pre>
<h2>Functions/predicates from ISO 9075-14 SQL/XML</h2>
<h3>XMLQUERY</h3>
<p>
 In the syntax of the SQL/XML standard, here is a query that would return
 an XML element representing the declaration of a function with a specified
 name:
<pre>
 SELECT XMLQUERY('/pg_catalog/pg_proc[proname eq $FUNCNAME]'
                 PASSING BY VALUE x, 'numeric_avg' AS FUNCNAME
                 RETURNING CONTENT EMPTY ON EMPTY)
 FROM catalog_as_xml;
</pre>
<p>
 It binds the 'context item' of the query to <code>x</code>, and the <code>NAME</code>
 parameter to the given value, then evaluates the query and returns XML
 "CONTENT" (a tree structure with a document node at the root, but not
 necessarily meeting all the requirements of an XML "DOCUMENT"). It can be
 rewritten as this call to the <a href="#xq_ret_content(java.lang.String,java.lang.Boolean,java.sql.ResultSet,java.lang.String%5B%5D)"><code>xq_ret_content</code></a> method:
<pre>
 SELECT javatest.xq_ret_content('/pg_catalog/pg_proc[proname eq $FUNCNAME]',
                                PASSING =&gt; p, nullOnEmpty =&gt; false)
 FROM catalog_as_xml,
 LATERAL (SELECT x AS ".", 'numeric_avg' AS "FUNCNAME") AS p;
</pre>
<p>
 In the rewritten form, the form of result wanted (<code>RETURNING CONTENT</code>)
 is implicit in the called function name (<code>xq_ret_content</code>), and the
 parameters to pass to the query are moved out to a separate <code>SELECT</code>
 that supplies their values, types, and names (with the context item now given
 the name ".") and is passed by its alias into the query function.
<p>
 Because of an unconditional uppercasing that PL/Java's JDBC driver currently
 applies to column names, any parameter names, such as <code>FUNCNAME</code> above,
 must be spelled in uppercase where used in the XQuery text, or they will not
 be recognized. Because the unconditional uppercasing is highly likely to be
 dropped in a future PL/Java release, it is wisest until then to use only
 parameter names that really are uppercase, both in the XQuery text where they
 are used and in the SQL expression that supplies them. In PostgreSQL,
 identifiers that are not quoted are <em>lower</em>cased, so they must be both
 uppercase and quoted, in the SQL syntax, to be truly uppercase.
<p>
 In the standard, parameters and results (of XML types) can be passed
 <code>BY VALUE</code> or <code>BY REF</code>, where the latter means that the same
 nodes will retain their XQuery node identities over calls (note that this is
 a meaning unrelated to what "by value" and "by reference" usually mean in
 PostgreSQL's documentation). PostgreSQL's implementation of the XML type
 provides no way for <code>BY REF</code> semantics to be implemented, so everything
 happening here happens <code>BY VALUE</code> implicitly, and does not need to be
 specified.
<h3>XMLEXISTS</h3>
<p>
 The function <a href="#xmlexists(java.lang.String,java.sql.ResultSet,java.lang.String%5B%5D)"><code>xmlexists</code></a> here implements the
 standard function of the same name. Because it is the same name, it has to
 be either schema-qualified or double-quoted in a call to avoid confusion
 with the reserved word. In the syntax of the SQL/XML standard, here is a
 query returning a boolean value indicating whether a function with the
 specified name is declared:
<pre>
 SELECT XMLEXISTS('/pg_catalog/pg_proc[proname eq $FUNCNAME]'
                  PASSING BY VALUE x, 'numeric_avg' AS FUNCNAME)
 FROM catalog_as_xml;
</pre>
<p>
 It can be rewritten as this call to the <a href="#xmlexists(java.lang.String,java.sql.ResultSet,java.lang.String%5B%5D)"><code>xmlexists</code></a> method:
<pre>
 SELECT "xmlexists"('/pg_catalog/pg_proc[proname eq $FUNCNAME]',
                    PASSING =&gt; p)
 FROM catalog_as_xml,
 LATERAL (SELECT x AS ".", 'numeric_avg' AS "FUNCNAME") AS p;
</pre>
<h3>XMLTABLE</h3>
<p>
 The function <a href="#xmltable(java.lang.String,java.lang.String%5B%5D,java.sql.ResultSet,java.lang.String%5B%5D,java.lang.Boolean)"><code>xmltable</code></a> here implements (much of) the
 standard function of the same name. Because it is the same name, it has to
 be either schema-qualified or double-quoted in a call to avoid confusion
 with the reserved word. A rewritten form of the <a href='https://www.postgresql.org/docs/10/static/functions-xml.html#FUNCTIONS-XML-PROCESSING-XMLTABLE'>first example in the PostgreSQL manual</a> could be:
<pre>
 SELECT xmltable.*
 FROM
    xmldata,

    LATERAL (SELECT data AS ".", 'not specified'::text AS "DPREMIER") AS p,

    "xmltable"('//ROWS/ROW', PASSING =&gt; p, COLUMNS =&gt; ARRAY[
     'data(@id)', null, 'COUNTRY_NAME',
     'COUNTRY_ID', 'SIZE[@unit eq "sq_km"]',
     'concat(SIZE[@unit ne "sq_km"], " ", SIZE[@unit ne "sq_km"]/@unit)',
     'let $e := PREMIER_NAME
      return if ( empty($e) )then $DPREMIER else $e'
    ]) AS (
     id int, ordinality int8, "COUNTRY_NAME" text, country_id text,
     size_sq_km float, size_other text, premier_name text
    );
</pre>
<p>
 In the first column expression, without the <code>data()</code> function, the
 result would be a bare attribute node (one not enclosed in an XML element).
 Many implementations will accept a bare attribute as a column expression
 result, and simply assume the attribute's value is wanted, but it appears
 that a strict implementation of the spec must raise <code>err:XPTY0004</code> in
 such a case. This implementation is meant to be strict, so the attribute is
 wrapped in <code>data()</code> to extract and return its value. (See
 "About bare attribute nodes" in <a href="#assignRowValues(java.sql.ResultSet,long)"><code>assignRowValues</code></a>
 for more explanation.)
<p>
 The <code>DPREMIER</code> parameter passed from SQL to the XQuery expression is
 spelled in uppercase (and also, in the SQL expression supplying it, quoted),
 for the reasons explained above for the <code>xq_ret_content</code> function.
<h3>XMLCAST</h3>
<p>
 An ISO standard cast expression like
<pre>
 XMLCAST(v AS wantedtype)
</pre>
 can be rewritten with this idiom and the <a href="#xmlcast(java.sql.ResultSet,java.lang.Boolean,java.sql.ResultSet)"><code>xmlcast</code></a> function
 provided here:
<pre>
 (SELECT r FROM (SELECT v) AS o, xmlcast(o) AS (r wantedtype))
</pre>
<h2>XQuery regular-expression functions in ISO 9075-2 Foundations</h2>
 The methods <a href="#like_regex(java.lang.String,java.lang.String,java.lang.String,boolean)"><code>like_regex</code></a>,
 <a href="#occurrences_regex(java.lang.String,java.lang.String,java.lang.String,int,boolean,boolean)"><code>occurrences_regex</code></a>,
 <a href="#position_regex(java.lang.String,java.lang.String,java.lang.String,int,boolean,boolean,int,int,boolean)"><code>position_regex</code></a>,
 <a href="#substring_regex(java.lang.String,java.lang.String,java.lang.String,int,boolean,int,int,boolean)"><code>substring_regex</code></a>, and
 <a href="#translate_regex(java.lang.String,java.lang.String,java.lang.String,java.lang.String,int,boolean,int,boolean)"><code>translate_regex</code></a> provide, with slightly altered
 syntax, the ISO SQL predicate and functions of the same names.
<p>
 For the moment, they will only match newlines in the way W3C XQuery
 specifies, not in the more-flexible Unicode-compatible way ISO SQL specifies,
 and for the ones where ISO SQL allows <code>USING CHARACTERS</code> or
 <code>USING OCTETS</code>, only <code>USING CHARACTERS</code> will work.
<h2>Extensions</h2>
<h3>XQuery module prolog allowed</h3>
<p>
 Where any function here accepts an XQuery
<a href='https://www.w3.org/TR/xquery-31/#id-expressions'>"expression"</a> according to the SQL specification, in fact an XQuery
<a href='https://www.w3.org/TR/xquery-31/#dt-main-module'>"main module"</a> will be accepted. Therefore, the query can be preceded by
 a prolog declaring namespaces, options, local variables and functions, etc.
<h3>Saxon extension to XQuery regular expressions</h3>
<p>
 Saxon's implementation of XQuery regular expressions will accept a
 nonstandard <em>flag</em> string ending with <code>;j</code> to use Java regular
 expressions rather than XQuery ones. That extension is available in the
 XQuery regular-expression methods provided here.</div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Chapman Flack</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<ul class="blockList">
<li class="blockList"><a id="nested.classes.inherited.from.class.org.postgresql.pljava.ResultSetProvider">
<!--   -->
</a>
<h3>Nested classes/interfaces inherited from interface&nbsp;org.postgresql.pljava.ResultSetProvider</h3>
<code>org.postgresql.pljava.ResultSetProvider.Large</code></li>
</ul>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<div class="memberSummary">
<div role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="memberSummary_tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="activeTableTab">All Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t1" class="tableTab" onclick="show(1);">Static Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t2" class="tableTab" onclick="show(2);">Instance Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t4" class="tableTab" onclick="show(8);">Concrete Methods</button></div>
<div id="memberSummary_tabpanel" role="tabpanel">
<table aria-labelledby="t0">
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor" id="i0">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#assignRowValues(java.sql.ResultSet,long)">assignRowValues</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/ResultSet.html?is-external=true" title="class or interface in java.sql" class="externalLink">ResultSet</a>&nbsp;receive,
               long&nbsp;currentRow)</code></th>
<td class="colLast">
<div class="block"><a id='assignRowValues'>Produce and return one row</a> of
 the <code>XMLTABLE</code> result table per call.</div>
</td>
</tr>
<tr class="rowColor" id="i1">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#close()">close</a></span>()</code></th>
<td class="colLast">
<div class="block">Called when PostgreSQL has no need for more rows of the tabular result.</div>
</td>
</tr>
<tr class="altColor" id="i2">
<td class="colFirst"><code>static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#like_regex(java.lang.String,java.lang.String,java.lang.String,boolean)">like_regex</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;value,
          <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;pattern,
          <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;flag,
          boolean&nbsp;w3cNewlines)</code></th>
<td class="colLast">
<div class="block">Function form of the ISO SQL
 <a id='like_regex'><code>&lt;regex like predicate&gt;</code></a>.</div>
</td>
</tr>
<tr class="rowColor" id="i3">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#occurrences_regex(java.lang.String,java.lang.String,java.lang.String,int,boolean,boolean)">occurrences_regex</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;pattern,
                 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;in,
                 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;flag,
                 int&nbsp;from,
                 boolean&nbsp;usingOctets,
                 boolean&nbsp;w3cNewlines)</code></th>
<td class="colLast">
<div class="block">Syntax-sugar-free form of the ISO SQL
 <a id='occurrences_regex'><code>OCCURRENCES_REGEX</code></a> function:
 how many times does a pattern occur in a string?</div>
</td>
</tr>
<tr class="altColor" id="i4">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#position_regex(java.lang.String,java.lang.String,java.lang.String,int,boolean,boolean,int,int,boolean)">position_regex</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;pattern,
              <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;in,
              <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;flag,
              int&nbsp;from,
              boolean&nbsp;usingOctets,
              boolean&nbsp;after,
              int&nbsp;occurrence,
              int&nbsp;group,
              boolean&nbsp;w3cNewlines)</code></th>
<td class="colLast">
<div class="block">Syntax-sugar-free form of the ISO SQL
 <a id='position_regex'><code>POSITION_REGEX</code></a> function:
 where does a pattern, or part of it, occur in a string?</div>
</td>
</tr>
<tr class="rowColor" id="i5">
<td class="colFirst"><code>static <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#substring_regex(java.lang.String,java.lang.String,java.lang.String,int,boolean,int,int,boolean)">substring_regex</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;pattern,
               <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;in,
               <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;flag,
               int&nbsp;from,
               boolean&nbsp;usingOctets,
               int&nbsp;occurrence,
               int&nbsp;group,
               boolean&nbsp;w3cNewlines)</code></th>
<td class="colLast">
<div class="block">Syntax-sugar-free form of the ISO SQL
 <a id='substring_regex'><code>SUBSTRING_REGEX</code></a> function:
 return a substring specified by a pattern match in a string.</div>
</td>
</tr>
<tr class="altColor" id="i6">
<td class="colFirst"><code>static <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#translate_regex(java.lang.String,java.lang.String,java.lang.String,java.lang.String,int,boolean,int,boolean)">translate_regex</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;pattern,
               <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;in,
               <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;flag,
               <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;with,
               int&nbsp;from,
               boolean&nbsp;usingOctets,
               int&nbsp;occurrence,
               boolean&nbsp;w3cNewlines)</code></th>
<td class="colLast">
<div class="block">Syntax-sugar-free form of the ISO SQL
 <a id='translate_regex'><code>TRANSLATE_REGEX</code></a> function:
 return a string constructed from the input string by replacing one
 specified occurrence, or all occurrences, of a matching pattern.</div>
</td>
</tr>
<tr class="rowColor" id="i7">
<td class="colFirst"><code>static boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#xmlcast(java.sql.ResultSet,java.lang.Boolean,java.sql.ResultSet)">xmlcast</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/ResultSet.html?is-external=true" title="class or interface in java.sql" class="externalLink">ResultSet</a>&nbsp;operand,
       <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Boolean.html?is-external=true" title="class or interface in java.lang" class="externalLink">Boolean</a>&nbsp;base64,
       <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/ResultSet.html?is-external=true" title="class or interface in java.sql" class="externalLink">ResultSet</a>&nbsp;target)</code></th>
<td class="colLast">
<div class="block">An implementation of XMLCAST.</div>
</td>
</tr>
<tr class="altColor" id="i8">
<td class="colFirst"><code>static <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Boolean.html?is-external=true" title="class or interface in java.lang" class="externalLink">Boolean</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#xmlexists(java.lang.String,java.sql.ResultSet,java.lang.String%5B%5D)">xmlexists</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;expression,
         <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/ResultSet.html?is-external=true" title="class or interface in java.sql" class="externalLink">ResultSet</a>&nbsp;passing,
         <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>[]&nbsp;namespaces)</code></th>
<td class="colLast">
<div class="block">An implementation of <code>XMLEXISTS(expression
 PASSING BY VALUE passing)</code>, using genuine XQuery.</div>
</td>
</tr>
<tr class="rowColor" id="i9">
<td class="colFirst"><code>static org.postgresql.pljava.ResultSetProvider</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#xmltable(java.lang.String,java.lang.String%5B%5D,java.sql.ResultSet,java.lang.String%5B%5D,java.lang.Boolean)">xmltable</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;rows,
        <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>[]&nbsp;columns,
        <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/ResultSet.html?is-external=true" title="class or interface in java.sql" class="externalLink">ResultSet</a>&nbsp;passing,
        <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>[]&nbsp;namespaces,
        <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Boolean.html?is-external=true" title="class or interface in java.lang" class="externalLink">Boolean</a>&nbsp;base64)</code></th>
<td class="colLast">
<div class="block">An implementation of (much of) XMLTABLE, using genuine XML Query.</div>
</td>
</tr>
<tr class="altColor" id="i10">
<td class="colFirst"><code>static <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLXML.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLXML</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#xmltext(java.lang.String)">xmltext</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;sve)</code></th>
<td class="colLast">
<div class="block">PostgreSQL (as of 12) lacks the XMLTEXT function, so here it is.</div>
</td>
</tr>
<tr class="rowColor" id="i11">
<td class="colFirst"><code>static <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLXML.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLXML</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#xq_ret_content(java.lang.String,java.lang.Boolean,java.sql.ResultSet,java.lang.String%5B%5D)">xq_ret_content</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;expression,
              <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Boolean.html?is-external=true" title="class or interface in java.lang" class="externalLink">Boolean</a>&nbsp;nullOnEmpty,
              <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/ResultSet.html?is-external=true" title="class or interface in java.sql" class="externalLink">ResultSet</a>&nbsp;passing,
              <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>[]&nbsp;namespaces)</code></th>
<td class="colLast">
<div class="block">A simple example corresponding to <code>XMLQUERY(expression
 PASSING BY VALUE passing RETURNING CONTENT {NULL|EMPTY} ON EMPTY)</code>.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Object.html?is-external=true" title="class or interface in java.lang" class="externalLink">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang" class="externalLink">clone</a>, <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang" class="externalLink">equals</a>, <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang" class="externalLink">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang" class="externalLink">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang" class="externalLink">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang" class="externalLink">notify</a>, <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang" class="externalLink">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang" class="externalLink">toString</a>, <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang" class="externalLink">wait</a>, <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Object.html?is-external=true#wait(long,int)" title="class or interface in java.lang" class="externalLink">wait</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.org.postgresql.pljava.ResultSetProvider.Large">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;org.postgresql.pljava.ResultSetProvider.Large</h3>
<code>assignRowValues</code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="xmltext(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>xmltext</h4>
<pre class="methodSignature">@Function(schema="javatest")
public static&nbsp;<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLXML.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLXML</a>&nbsp;<a href="../../../../../src-html/org/postgresql/pljava/example/saxon/S9.html#line.402">xmltext</a>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;sve)
                      throws <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></pre>
<div class="block">PostgreSQL (as of 12) lacks the XMLTEXT function, so here it is.
<p>
 As long as PostgreSQL does not have the <code>XML(SEQUENCE)</code> type,
 this can only be the <code>XMLTEXT(sve RETURNING CONTENT)</code> flavor, which
 does create a text node with <code>sve</code> as its value, but returns the
 text node wrapped in a document node.
<p>
 This function doesn't actually require Saxon, but otherwise fits in with
 the theme here, implementing missing parts of SQL/XML for PostgreSQL.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sve</code> - SQL string value to use in a text node</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>XML content, the text node wrapped in a document node</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></code></dd>
</dl>
</li>
</ul>
<a id="xmlcast(java.sql.ResultSet,java.lang.Boolean,java.sql.ResultSet)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>xmlcast</h4>
<pre class="methodSignature">@Function(schema="javatest",
          type="pg_catalog.record",
          onNullInput=CALLED,
          settings="IntervalStyle TO iso_8601")
public static&nbsp;boolean&nbsp;<a href="../../../../../src-html/org/postgresql/pljava/example/saxon/S9.html#line.459">xmlcast</a>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/ResultSet.html?is-external=true" title="class or interface in java.sql" class="externalLink">ResultSet</a>&nbsp;operand,
                              @SQLType(defaultValue="false")
                              <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Boolean.html?is-external=true" title="class or interface in java.lang" class="externalLink">Boolean</a>&nbsp;base64,
                              <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/ResultSet.html?is-external=true" title="class or interface in java.sql" class="externalLink">ResultSet</a>&nbsp;target)
                       throws <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></pre>
<div class="block">An implementation of XMLCAST.
<p>
 Will be declared to take and return type <code>RECORD</code>, where each must
 have exactly one component, just because that makes it easy to use
 existing JDBC metadata queries to find out the operand and target SQL
 data types.
<p>
 Serving suggestion: rewrite this ISO standard expression
<pre>
 XMLCAST(v AS wantedtype)
</pre>
 to this idiomatic one:
<pre>
 (SELECT r FROM (SELECT v) AS o, xmlcast(o) AS (r wantedtype))
</pre></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>operand</code> - a one-row, one-column record supplied by the caller, whose
 one typed value is the operand to be cast.</dd>
<dd><code>base64</code> - true if binary SQL values should be base64-encoded in XML;
 if false (the default), values will be encoded in hex.</dd>
<dd><code>target</code> - a one-row, one-column record supplied by PL/Java from the
 <code>AS</code> clause after the function call, whose one column's type is the
 type to be cast to.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></code></dd>
</dl>
</li>
</ul>
<a id="xq_ret_content(java.lang.String,java.lang.Boolean,java.sql.ResultSet,java.lang.String[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>xq_ret_content</h4>
<pre class="methodSignature">@Function(schema="javatest",
          onNullInput=CALLED,
          settings="IntervalStyle TO iso_8601")
public static&nbsp;<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLXML.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLXML</a>&nbsp;<a href="../../../../../src-html/org/postgresql/pljava/example/saxon/S9.html#line.617">xq_ret_content</a>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;expression,
                                    <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Boolean.html?is-external=true" title="class or interface in java.lang" class="externalLink">Boolean</a>&nbsp;nullOnEmpty,
                                    @SQLType(defaultValue={})
                                    <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/ResultSet.html?is-external=true" title="class or interface in java.sql" class="externalLink">ResultSet</a>&nbsp;passing,
                                    @SQLType(defaultValue={})
                                    <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>[]&nbsp;namespaces)
                             throws <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></pre>
<div class="block">A simple example corresponding to <code>XMLQUERY(expression
 PASSING BY VALUE passing RETURNING CONTENT {NULL|EMPTY} ON EMPTY)</code>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>expression</code> - An XQuery expression. Must not be <code>null</code> (in the
 SQL standard <code>XMLQUERY</code> syntax, it is not even allowed to be an
 SQL expression at all, only a string literal).</dd>
<dd><code>nullOnEmpty</code> - pass <code>true</code> to get a null return in place of
 an empty sequence, or <code>false</code> to just get the empty sequence.</dd>
<dd><code>passing</code> - A row value whose columns will be supplied to the query
 as parameters. Columns with names (typically supplied with <code>AS</code>)
 appear as predeclared external variables with matching names (in no
 namespace) in the query, with types derived from the SQL types of the
 row value's columns. There may be one (and no more than one)
 column with <code>AS "."</code> which, if present, will be bound as the
 context item. (The name <code>?column?</code>, which PostgreSQL uses for an
 otherwise-unnamed column, is also accepted, which will often allow the
 context item to be specified with no <code>AS</code> at all. Beware, though,
 that PostgreSQL likes to invent column names from any function or type
 name that may appear in the value expression, so this shorthand will not
 always work, while <code>AS "."</code> will.) PL/Java's internal JDBC uppercases all column
 names, so any uses of the corresponding variables in the query must have
 the names in upper case. It is safest to also uppercase their appearances
 in the SQL (for which, in PostgreSQL, they must be quoted), so that the
 JDBC uppercasing is not being relied on. It is likely to be dropped in a
 future PL/Java release.</dd>
<dd><code>namespaces</code> - An even-length String array where, of each pair of
 consecutive entries, the first is a namespace prefix and the second is
 the URI to which to bind it. The zero-length prefix sets the default
 element and type namespace; if the prefix has zero length, the URI may
 also have zero length, to declare that unprefixed elements are in no
 namespace.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></code></dd>
</dl>
</li>
</ul>
<a id="xmlexists(java.lang.String,java.sql.ResultSet,java.lang.String[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>xmlexists</h4>
<pre class="methodSignature">@Function(schema="javatest",
          onNullInput=CALLED,
          settings="IntervalStyle TO iso_8601")
public static&nbsp;<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Boolean.html?is-external=true" title="class or interface in java.lang" class="externalLink">Boolean</a>&nbsp;<a href="../../../../../src-html/org/postgresql/pljava/example/saxon/S9.html#line.685">xmlexists</a>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;expression,
                                @SQLType(defaultValue={})
                                <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/ResultSet.html?is-external=true" title="class or interface in java.sql" class="externalLink">ResultSet</a>&nbsp;passing,
                                @SQLType(defaultValue={})
                                <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>[]&nbsp;namespaces)
                         throws <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></pre>
<div class="block">An implementation of <code>XMLEXISTS(expression
 PASSING BY VALUE passing)</code>, using genuine XQuery.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>expression</code> - An XQuery expression. Must not be <code>null</code> (in the
 SQL standard <code>XMLQUERY</code> syntax, it is not even allowed to be an
 SQL expression at all, only a string literal).</dd>
<dd><code>passing</code> - A row value whose columns will be supplied to the query
 as parameters. Columns with names (typically supplied with <code>AS</code>)
 appear as predeclared external variables with matching names (in no
 namespace) in the query, with types derived from the SQL types of the
 row value's columns. There may be one (and no more than one)
 column with <code>AS "."</code> which, if present, will be bound as the
 context item. (The name <code>?column?</code>, which PostgreSQL uses for an
 otherwise-unnamed column, is also accepted, which will often allow the
 context item to be specified with no <code>AS</code> at all. Beware, though,
 that PostgreSQL likes to invent column names from any function or type
 name that may appear in the value expression, so this shorthand will not
 always work, while <code>AS "."</code> will.) PL/Java's internal JDBC uppercases all column
 names, so any uses of the corresponding variables in the query must have
 the names in upper case. It is safest to also uppercase their appearances
 in the SQL (for which, in PostgreSQL, they must be quoted), so that the
 JDBC uppercasing is not being relied on. It is likely to be dropped in a
 future PL/Java release.</dd>
<dd><code>namespaces</code> - An even-length String array where, of each pair of
 consecutive entries, the first is a namespace prefix and the second is
 the URI to which to bind it. The zero-length prefix sets the default
 element and type namespace; if the prefix has zero length, the URI may
 also have zero length, to declare that unprefixed elements are in no
 namespace.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>True if the expression evaluates to a nonempty sequence, false if
 it evaluates to an empty one. Null if a context item is passed and its
 SQL value is null.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></code></dd>
</dl>
</li>
</ul>
<a id="xmltable(java.lang.String,java.lang.String[],java.sql.ResultSet,java.lang.String[],java.lang.Boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>xmltable</h4>
<pre class="methodSignature">@Function(schema="javatest",
          onNullInput=CALLED,
          settings="IntervalStyle TO iso_8601")
public static&nbsp;org.postgresql.pljava.ResultSetProvider&nbsp;<a href="../../../../../src-html/org/postgresql/pljava/example/saxon/S9.html#line.824">xmltable</a>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;rows,
                                                               <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>[]&nbsp;columns,
                                                               @SQLType(defaultValue={})
                                                               <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/ResultSet.html?is-external=true" title="class or interface in java.sql" class="externalLink">ResultSet</a>&nbsp;passing,
                                                               @SQLType(defaultValue={})
                                                               <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>[]&nbsp;namespaces,
                                                               @SQLType(defaultValue="false")
                                                               <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/Boolean.html?is-external=true" title="class or interface in java.lang" class="externalLink">Boolean</a>&nbsp;base64)
                                                        throws <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></pre>
<div class="block">An implementation of (much of) XMLTABLE, using genuine XML Query.
<p>
 The <code>columns</code> array must supply a valid XML Query expression for
 every column in the column definition list that follows the call of this
 function in SQL, except that the column for ordinality, if wanted, is
 identified by a <code>null</code> entry in <code>columns</code>. Syntax sugar in
 the standard allows an omitted column expression to imply an element test
 for an element with the same name as the column; that doesn't work here.
<p>
 For now, this implementation lacks the ability to specify defaults for
 when a column expression produces an empty sequence. It is possible to
 do defaults explicitly by rewriting a query expression <em>expr</em> as
 <code>let $e := </code><em>expr</em><code>return if(empty($e))then $D else $e</code>
 and supplying the default <em>D</em> as another query parameter, though
 such defaults will be evaluated only once when <code>xmltable</code> is called
 and will not be able to refer to other values in an output row.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>rows</code> - The single XQuery expression whose result sequence generates
 the rows of the resulting table. Must not be null.</dd>
<dd><code>columns</code> - Array of XQuery expressions, exactly as many as result
 columns in the column definition list that follows the SQL call to this
 function. This array must not be null. It is allowed for one element (and
 no more than one) to be null, marking the corresponding column to be
 "FOR ORDINALITY" (the column must be of "exact numeric with scale zero"
 type; PostgreSQL supports 64-bit row counters, so <code>int8</code> is
 recommended).</dd>
<dd><code>passing</code> - A row value whose columns will be supplied to the query
 as parameters, just as described for
 <a href="#xq_ret_content(java.lang.String,java.lang.Boolean,java.sql.ResultSet,java.lang.String%5B%5D)"><code>xq_ret_content()</code></a>. If a context item is supplied,
 it is the context item for the <code>rows</code> query (the <code>columns</code>
 queries get their context item from the <code>rows</code> query's result). Any
 named parameters supplied here are available both in the <code>rows</code>
 expression and (though this goes beyond the standard) in every expression
 of <code>columns</code>, with their values unchanging from row to row.</dd>
<dd><code>namespaces</code> - An even-length String array where, of each pair of
 consecutive entries, the first is a namespace prefix and the second is
 to URI to which to bind it, just as described for
 <a href="#xq_ret_content(java.lang.String,java.lang.Boolean,java.sql.ResultSet,java.lang.String%5B%5D)"><code>xq_ret_content()</code></a>.</dd>
<dd><code>base64</code> - whether the effective, in-scope 'xmlbinary' setting calls
 for base64 or (the default, false) hexadecimal.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></code></dd>
</dl>
</li>
</ul>
<a id="close()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;<a href="../../../../../src-html/org/postgresql/pljava/example/saxon/S9.html#line.911">close</a>()</pre>
<div class="block">Called when PostgreSQL has no need for more rows of the tabular result.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>close</code>&nbsp;in interface&nbsp;<code>org.postgresql.pljava.ResultSetProvider</code></dd>
</dl>
</li>
</ul>
<a id="assignRowValues(java.sql.ResultSet,long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>assignRowValues</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;<a href="../../../../../src-html/org/postgresql/pljava/example/saxon/S9.html#line.1192">assignRowValues</a>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/ResultSet.html?is-external=true" title="class or interface in java.sql" class="externalLink">ResultSet</a>&nbsp;receive,
                               long&nbsp;currentRow)
                        throws <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></pre>
<div class="block"><a id='assignRowValues'>Produce and return one row</a> of
 the <code>XMLTABLE</code> result table per call.
<p>
 The row expression has already been compiled and its evaluation begun,
 producing a sequence iterator. The column XQuery expressions have all
 been compiled and are ready to evaluate, and the compiler's static
 analysis has bounded the data types they will produce. Because of the
 way the set-returning function protocol works, we don't know the types
 of the SQL output columns yet, until the first call of this function,
 when the <code>receive</code> parameter's <code>ResultSetMetaData</code> can be
 inspected to find out. So that will be the first thing done when called
 with <code>currentRow</code> of zero.
<p>
 Each call will then: (a) get the next value from the row expression's
 sequence iterator, then for each column, (b) evaluate that column's
 XQuery expression on the row value, and (c) assign that column's result
 to the SQL output column, casting to the proper type (which the SQL/XML
 spec has very exacting rules on how to do).
<p>
 A note before going any further: this implementation, while fairly
 typical of a PostgreSQL set-returning user function, is <em>not</em> the
 way the SQL/XML spec defines <code>XMLTABLE</code>. The official behavior of
 <code>XMLTABLE</code> is defined in terms of a rewriting, at the SQL level,
 into a much-expanded SQL query where each result column appears as an
 <code>XMLQUERY</code> call applying the column expression, wrapped in an
 <code>XMLCAST</code> to the result column type (with a
 <code>CASE WHEN XMLEXISTS</code> thrown in to support column defaults).
<p>
 As an ordinary user function, this example cannot rely on any fancy
 query rewriting during PostgreSQL's parse analysis. The slight syntax
 desugaring needed to transform a standard <code>XMLTABLE</code> call into a
 call of this "xmltable" is not too hard to learn and do by hand, but no
 one would ever want to write out by hand the whole longwinded "official"
 expansion prescribed in the spec. So this example is a compromise.
<p>
 The main thing lost in the compromise is the handling of column defaults.
 The full rewriting with per-column SQL expressions means that each
 column default expression can be evaluated exactly when/if needed, which
 is often the desired behavior. This implementation as an ordinary
 function, whose arguments all get evaluated ahead of the call, can't
 really do that. Otherwise, there's nothing in the spec that's inherently
 unachievable in this implementation.
<p>
 Which brings us to the matter of casting each column expression result
 to the proper type for its SQL result column.
<p>
 Like any spec, <code>SQL/XML</code> does not mandate that an implementation
 must be done in exactly the way presented in the spec (rewritten so each
 column value is produced by an <code>XMLQUERY</code> wrapped in an
 <code>XMLCAST</code>). The requirement is to produce the equivalent result.
<p>
 A look at the rewritten query shows that each column XQuery result value
 must be representable as some value in SQL's type system, not once, but
 twice: first as the result returned by <code>XMLQUERY</code> and passed along
 to <code>XMLCAST</code>, and finally with the output column's type as the
 result of the <code>XMLCAST</code>.
<p>
 Now, the output column type can be whatever is wanted. Importantly, it
 can be either an XML type, or any ordinary SQL scalar type, like a
 <code>float</code> or a <code>date</code>. Likewise, the XQuery column expression
 may have produced some atomic value (like an <code>xs:double</code> or
 <code>xs:date</code>), or some XML node, or any sequence of any of those.
<p>
 What are the choices for the type in the middle: the SQL value returned
 by <code>XMLQUERY</code> and passed on to <code>XMLCAST</code>?
<p>
 There are two. An ISO-standard SQL <code>XMLQUERY</code> can specify
 <code>RETURNING SEQUENCE</code> or <code>RETURNING CONTENT</code>. The first option
 produces the type <code>XML(SEQUENCE)</code>, a useful type that PostgreSQL
 does not currently have. <code>XML(SEQUENCE)</code> can hold exactly whatever
 an XQuery expression can produce: a sequence of any length, of any
 mixture of atomic values and XML nodes (even such oddities as attribute
 nodes outside of any element), in any order. An <code>XML(SEQUENCE)</code>
 value need not look anything like what "XML" normally brings to mind.
<p>
 With the other option, <code>RETURNING CONTENT</code>, the result of
 <code>XMLQUERY</code> has to be something that PostgreSQL's <code>xml</code> type
 could store: a serialized document with XML structure, but without the
 strict requirements of exactly one root element with no text outside it.
 At the limit, a completely non-XMLish string of ordinary text is
 perfectly acceptable XML <code>CONTENT</code>, as long as it uses the right
 <code>&amp;...;</code> escapes for any characters that could look like XML markup.
<p>
 <code>XMLCAST</code> is able to accept either form as input, and deliver it
 to the output column as whatever type is needed. But the spec leaves no
 wiggle room as to which form to use:
<ul>
<li>If the result column type is <code>XML(SEQUENCE)</code>, then the
 <code>XMLQUERY</code> is to specify <code>RETURNING SEQUENCE</code>. It produces
 the column's result type directly, so the <code>XMLCAST</code> has nothing
 to do.
<li>In every other case (<em>every</em> other case), the <code>XMLQUERY</code>
 is to specify <code>RETURNING CONTENT</code>.
</ul>
<p>
 At first blush, that second rule should sound crazy. Imagine a column
 definition like
<pre>
 growth float8 PATH 'math:pow(1.0 + $RATE, count(year))'
</pre>
 The expression produces an <code>xs:double</code>, which can be assigned
 directly to a PostgreSQL <code>float8</code>, but the rule in the spec will
 have it first converted to a decimal string representation, made into
 a text node, wrapped in a document node, and returned as XML, to be
 passed along to <code>XMLCAST</code>, which parses it, discards the wrapping
 document node, parses the text content as a double, and returns that as
 a proper value of the result column type (which, in this example, it
 already is).
<p>
 The spec does not go into why this rule was chosen. The only rationale
 that makes sense to me is that the <code>XML(SEQUENCE)</code> data type
 is an SQL feature (X190) that not every implementation will support,
 so the spec has to define <code>XMLTABLE</code> using a rewritten query that
 can work on systems that do not have that type. (PostgreSQL itself, at
 present, does not have it.)
<p>
 The first rule, when <code>XML(SEQUENCE)</code> is the result column type,
 will naturally never be in play except on a system that has that type, in
 which case it can be used directly. But even such a system must still
 produce, in all other cases, results that match what a system without
 that type would produce. All those cases are therefore defined as if
 going the long way through <code>XML(CONTENT)</code>.
<p>
 Whenever the XQuery expression can be known to produce a (possibly empty
 or) singleton sequence of an atomic type, the long round trip can be
 shown to be idempotent, and we can skip right to casting the atomic type
 to the SQL result column type. A few other cases could be short-circuited
 the same way. But in general, for cases involving nodes or non-singleton
 sequences, it is safest to follow the spec punctiliously; the steps are
 defined in terms of XQuery constructs like <code>document {...}</code> and
 <code>data()</code>, which have specs of their own with many traps for the
 unwary, and the XQuery library provides implementations of them that are
 already tested and correct.
<p>
 Though most of the work can be done by the XQuery library, it may be
 helpful to look closely at just what the specification entails.
<p>
 Again, but for the case of an <code>XML(SEQUENCE)</code> result column, in all
 other cases the result must pass through
 <code>XMLQUERY(... RETURNING CONTENT EMPTY ON EMPTY)</code>. That, in turn, is
 defined as equivalent to <code>XMLQUERY(... RETURNING SEQUENCE)</code> with
 the result then passed to <code>XMLDOCUMENT(... RETURNING CONTENT)</code>,
 whose behavior is that of a
 <a href='https://www.w3.org/TR/xquery-31/#id-documentConstructors'>
 document node constructor</a> in XQuery, with
 <a href='https://www.w3.org/TR/xquery-31/#dt-construction-mode'>
 construction mode</a> <code>preserve</code>. The first step of that behavior
 is the same as Step 1e in the processing of
 <a href='https://www.w3.org/TR/xquery-31/#id-content'>direct element
 constructor content</a>. The remaining steps are those laid out for the
 document node constructor.
<p>
 Clarity demands flattening this nest of specifications into a single
 ordered list of the steps to apply:
<ul>
<li>Any item in the sequence that is an array is flattened (its elements
 become items in the sequence).
<li>If any item is a function, <code>err:XQTY0105</code> is raised.
<li>Any sequence <code>$s</code> of adjacent atomic values is replaced by
 <code>string-join($s, ' ')</code>.
<li>Any XML node in the sequence is copied (as detailed in the spec).
<li>After all the above, any document node that may exist in the resulting
 sequence is flattened (replaced by its children).
<li>A single text node is produced for any run of adjacent text nodes in
 the sequence (including any that have newly become adjacent by the
 flattening of document nodes), by concatenation with no separator (unlike
 the earlier step where atomic values were concatenated with a space as
 the separator).
<li>If the sequence directly contains any attribute or namespace node,
 <code>err:XPTY0004</code> is raised. <b>More on this below.</b>
<li>The sequence resulting from the preceding steps is wrapped in one
 new document node (as detailed in the spec).
</ul>
<p>
 At this point, the result could be returned to SQL as a value of
 <code>XML(CONTENT(ANY))</code> type, to be passed to an <code>XMLCAST</code>
 invocation. This implementation avoids that, and simply proceeds with the
 existing Java in-memory representation of the document tree, to the
 remaining steps entailed in an <code>XMLCAST</code> to the output column type:
<ul>
<li>If the result column type is an XML type, rewriting would turn the
 <code>XMLCAST</code> into a simple <code>CAST</code> and that's that. Otherwise,
 the result column has some non-XML, SQL type, and:
<li>The algorithm "Removing XQuery document nodes from an XQuery sequence"
 is applied. By construction, we know the only such node is the one the
 whole sequence was recently wrapped in, two steps ago (you get your
 house back, you get your dog back, you get your truck back...).
<li>That sequence of zero or more XML nodes is passed to the
<a href='https://www.w3.org/TR/xpath-functions-31/#func-data'>fn:data</a>
 function, producing a sequence of zero or more atomic values, which will
 all have type <code>xs:untypedAtomic</code> (because the document-wrapping
 stringified any original atomic values and wrapped them in text nodes,
 for which the
 <a href='https://www.w3.org/TR/xpath-datamodel-31/#acc-summ-typed-value'>
 typed-value</a> is <code>xs:untypedAtomic</code> by definition). This sequence
 also has cardinality zero-or-more, and may be shorter or longer than the
 original.
<li>If the sequence is empty, the result column is assigned <code>NULL</code>
 (or the column's default value, if one was specified). Otherwise, the
 sequence is known to have length one or more, and:
<li>The spec does not say this (which may be an oversight or bug), but the
 sequence must be checked for length greater than one, raising
 <code>err:XPTY0004</code> in that case. The following steps require it to be a
 singleton.
<li>It is labeled as a singleton sequence of <code>xs:anyAtomicType</code> and
 used as input to an XQuery <code>cast as</code> expression. (Alternatively, it
 could be labeled a one-or-more sequence of <code>xs:anyAtomicType</code>,
 leaving the length check to be done by <code>cast as</code>, which would raise
 the same error <code>err:XPTY0004</code>, if longer than one.)
<li>The <code>cast as</code> is to the XQuery type determined as in
 <code>determineXQueryFormalType</code> below, based on the SQL type of the
 result column; or, if the SQL type is a date/time type with no time zone,
 there is a first <code>cast as</code> to a specific XSD date/time type, which
 is (if it has a time zone) first adjusted to UTC, then stripped of its
 time zone, followed by a second <code>cast as</code> from that type to the one
 determined from the result column type. Often, that will be the same type
 as was used for the time zone adjustment, and the second <code>cast as</code>
 will have nothing to do.
<li>The XQuery value resulting from the cast is converted and assigned to
 the SQL-typed result column, a step with many details but few surprises,
 therefore left for the morbidly curious to explore in the code. The flip
 side of the time zone removal described above happens here: if the SQL
 column type expects a time zone and the incoming value lacks one, it is
 given a zone of UTC.
</ul>
<p>
 The later steps above, those following the length-one check, are
 handled by <code>xmlCastAsNonXML</code> below.
<p>
 The earlier steps, from the start through the <code>XMLCAST</code> early steps
 of document-node unwrapping, can all be applied by letting the original
 result sequence be <code>$EXPR</code> in the expression:
<pre>
 declare construction preserve;
 data(document { $EXPR } / child::node())
</pre>
 which may seem a bit of an anticlimax after seeing how many details lurk
 behind those tidy lines of code.
<p>
 <strong>About bare attribute nodes</strong>
<p>
 One consequence of the rules above deserves special attention.
 Consider something like:
<pre>
 XMLTABLE('.' PASSING '&lt;a foo="bar"/&gt;' COLUMNS c1 VARCHAR PATH 'a/@foo');
</pre>
<p>
 The result of the column expression is an XML attribute node all on its
 own, with name <code>foo</code> and value <code>bar</code>, not enclosed in any
 XML element. In the data type <code>XML(SEQUENCE)</code>, an attribute node
 can appear standalone like that, but not in <code>XML(CONTENT)</code>.
<p>
 Db2, Oracle, and even the XPath-based pseudo-XMLTABLE built into
 PostgreSQL, will all accept that query and produce the result "bar".
<p>
 However, a strict interpretation of the spec cannot produce that result,
 because the result column type (<code>VARCHAR</code>) is not
 <code>XML(SEQUENCE)</code>, meaning the result must be as if passed through
 <code>XMLDOCUMENT(... RETURNING CONTENT)</code>, and the XQuery
 <code>document { ... }</code> constructor is required to raise
 <code>err:XPTY0004</code> upon encountering any bare attribute node. The
 apparently common, convenient behavior of returning the attribute node's
 value component is not, strictly, conformant.
<p>
 This implementation will raise <code>err:XPTY0004</code>. That can be avoided
 by simply wrapping any such bare attribute in <code>data()</code>:
<pre>
 ... COLUMNS c1 VARCHAR PATH 'a/data(@foo)');
</pre>
<p>
 It is possible the spec has an editorial mistake and did not intend to
 require an error for this usage, in which case this implementation can
 be changed to match a future clarification of the spec.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>assignRowValues</code>&nbsp;in interface&nbsp;<code>org.postgresql.pljava.ResultSetProvider</code></dd>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code>assignRowValues</code>&nbsp;in interface&nbsp;<code>org.postgresql.pljava.ResultSetProvider.Large</code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></code></dd>
</dl>
</li>
</ul>
<a id="like_regex(java.lang.String,java.lang.String,java.lang.String,boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>like_regex</h4>
<pre class="methodSignature">@Function(schema="javatest")
public static&nbsp;boolean&nbsp;<a href="../../../../../src-html/org/postgresql/pljava/example/saxon/S9.html#line.2986">like_regex</a>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;value,
                                 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;pattern,
                                 @SQLType(defaultValue="")
                                 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;flag,
                                 @SQLType(defaultValue="false")
                                 boolean&nbsp;w3cNewlines)
                          throws <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></pre>
<div class="block">Function form of the ISO SQL
 <a id='like_regex'><code>&lt;regex like predicate&gt;</code></a>.
<p>
 Rewrite the standard form
<pre>
 value LIKE_REGEX pattern FLAG flags
</pre>
 into this form:
<pre>
 like_regex(value, pattern, flag =&gt; flags)
</pre>
 where the <code>flag</code> parameter defaults to no flags if omitted.
<p>
 The SQL standard specifies that pattern elements sensitive to newlines
 (namely <code>^</code>, <code>$</code>, <code>\s</code>, <code>\S</code>, and <code>.</code>) are
 to support the various representations of newline set out in
 <a href='http://www.unicode.org/reports/tr18/#RL1.6'>Unicode Technical
 Standard #18, RL1.6</a>. That behavior differs from the standard W3C
 XQuery newline handling, as described for
 <a href='https://www.w3.org/TR/xpath-functions-31/#flags'>the flags
 <code>m</code> and <code>s</code></a> and for
 <a href='https://www.w3.org/TR/xmlschema11-2/#cces-mce'>the
 multicharacter escapes <code>\s</code> and <code>\S</code></a>. As an extension to
 ISO SQL, passing <code>w3cNewlines =&gt; true</code> requests the standard W3C
 XQuery behavior rather than the UTS#18 behevior for newlines. If the
 underlying XQuery library only provides the W3C behavior, calls without
 <code>w3cNewlines =&gt; true</code> will throw exceptions.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>value</code> - The string to be tested against the pattern.</dd>
<dd><code>pattern</code> - The XQuery regular expression.</dd>
<dd><code>flag</code> - Optional string of
 <a href='https://www.w3.org/TR/xpath-functions-31/#flags'>flags adjusting
 the regular expression behavior</a>.</dd>
<dd><code>w3cNewlines</code> - Pass true to allow the regular expression to recognize
 newlines according to the W3C XQuery rules rather than those of ISO SQL.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>True if the supplied value matches the pattern. Null if any
 parameter is null.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></code> - SQLDataException with SQLSTATE 2201S if the regular
 expression is invalid, 2201T if the flags string is invalid;
 SQLFeatureNotSupportedException (0A000) if (in the current
 implementation) w3cNewlines is false or omitted.</dd>
</dl>
</li>
</ul>
<a id="occurrences_regex(java.lang.String,java.lang.String,java.lang.String,int,boolean,boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>occurrences_regex</h4>
<pre class="methodSignature">@Function(schema="javatest")
public static&nbsp;int&nbsp;<a href="../../../../../src-html/org/postgresql/pljava/example/saxon/S9.html#line.3039">occurrences_regex</a>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;pattern,
                                    @SQLType(name="\"in\"")
                                    <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;in,
                                    @SQLType(defaultValue="")
                                    <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;flag,
                                    @SQLType(name="\"from\"",defaultValue="1")
                                    int&nbsp;from,
                                    @SQLType(defaultValue="false")
                                    boolean&nbsp;usingOctets,
                                    @SQLType(defaultValue="false")
                                    boolean&nbsp;w3cNewlines)
                             throws <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></pre>
<div class="block">Syntax-sugar-free form of the ISO SQL
 <a id='occurrences_regex'><code>OCCURRENCES_REGEX</code></a> function:
 how many times does a pattern occur in a string?
<p>
 Rewrite the standard form
<pre>
 OCCURRENCES_REGEX(pattern FLAG flags IN str FROM position USING units)
</pre>
 into this form:
<pre>
 occurrences_regex(pattern, flag =&gt; flags, "in" =&gt; str,
                   "from" =&gt; position, usingOctets =&gt; true|false)
</pre>
 where all of the named parameters are optional except pattern and "in",
 and the standard <code>USING CHARACTERS</code> becomes
 <code>usingOctets =&gt; false</code>, which is the default, and
 <code>USING OCTETS</code> becomes <code>usingOctets =&gt; true</code>. See also
 <a href="#like_regex(java.lang.String,java.lang.String,java.lang.String,boolean)"><code>like_regex</code></a> regarding the <code>w3cNewlines</code>
 parameter.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>pattern</code> - XQuery regular expression to seek in the input string.</dd>
<dd><code>in</code> - The input string.</dd>
<dd><code>flag</code> - Optional string of
 <a href='https://www.w3.org/TR/xpath-functions-31/#flags'>flags adjusting
 the regular expression behavior</a>.</dd>
<dd><code>from</code> - Starting position in the input string, 1 by default.</dd>
<dd><code>usingOctets</code> - Whether position is counted in characters (actual
 Unicode characters, not any smaller encoded unit, not even Java char),
 which is the default, or (when true) in octets of the string's encoded
 form.</dd>
<dd><code>w3cNewlines</code> - Pass true to allow the regular expression to recognize
 newlines according to the W3C XQuery rules rather than those of ISO SQL.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The number of occurrences of the pattern in the input string,
 starting from the specified position. Null if any parameter is null; -1
 if the start position is less than 1 or beyond the end of the string.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></code> - SQLDataException with SQLSTATE 2201S if the regular
 expression is invalid, 2201T if the flags string is invalid;
 SQLFeatureNotSupportedException (0A000) if (in the current
 implementation) usingOctets is true, or w3cNewlines is false or omitted.</dd>
</dl>
</li>
</ul>
<a id="position_regex(java.lang.String,java.lang.String,java.lang.String,int,boolean,boolean,int,int,boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>position_regex</h4>
<pre class="methodSignature">@Function(schema="javatest")
public static&nbsp;int&nbsp;<a href="../../../../../src-html/org/postgresql/pljava/example/saxon/S9.html#line.3118">position_regex</a>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;pattern,
                                 @SQLType(name="\"in\"")
                                 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;in,
                                 @SQLType(defaultValue="")
                                 <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;flag,
                                 @SQLType(name="\"from\"",defaultValue="1")
                                 int&nbsp;from,
                                 @SQLType(defaultValue="false")
                                 boolean&nbsp;usingOctets,
                                 @SQLType(defaultValue="false")
                                 boolean&nbsp;after,
                                 @SQLType(defaultValue="1")
                                 int&nbsp;occurrence,
                                 @SQLType(name="\"group\"",defaultValue="0")
                                 int&nbsp;group,
                                 @SQLType(defaultValue="false")
                                 boolean&nbsp;w3cNewlines)
                          throws <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></pre>
<div class="block">Syntax-sugar-free form of the ISO SQL
 <a id='position_regex'><code>POSITION_REGEX</code></a> function:
 where does a pattern, or part of it, occur in a string?
<p>
 Rewrite the standard forms
<pre>
 POSITION_REGEX(START pattern FLAG flags IN str FROM position
                OCCURRENCE n GROUP m)
 POSITION_REGEX(AFTER pattern FLAG flags IN str FROM position
                OCCURRENCE n GROUP m)
</pre>
 into these forms, respectively:
<pre>
 position_regex(pattern, flag =&gt; flags, "in" =&gt; str,
                "from" =&gt; position, occurrence =&gt; n,
                "group" =&gt; m)
 position_regex(pattern, flag =&gt; flags, "in" =&gt; str,
                "from" =&gt; position, occurrence =&gt; n,
                "group" =&gt; m, after =&gt; true)
</pre>
 where all of the named parameters are optional except pattern and "in".
 See also <a href="#occurrences_regex(java.lang.String,java.lang.String,java.lang.String,int,boolean,boolean)"><code>occurrences_regex</code></a> regarding the
 <code>usingOctets</code> parameter, and <a href="#like_regex(java.lang.String,java.lang.String,java.lang.String,boolean)"><code>like_regex</code></a>
 regarding <code>w3cNewlines</code>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>pattern</code> - XQuery regular expression to seek in the input string.</dd>
<dd><code>in</code> - The input string.</dd>
<dd><code>flag</code> - Optional string of
 <a href='https://www.w3.org/TR/xpath-functions-31/#flags'>flags adjusting
 the regular expression behavior</a>.</dd>
<dd><code>from</code> - Starting position in the input string, 1 by default.</dd>
<dd><code>usingOctets</code> - Whether position is counted in characters (actual
 Unicode characters, not any smaller encoded unit, not even Java char),
 which is the default, or (when true) in octets of the string's encoded
 form.</dd>
<dd><code>after</code> - Whether to return the position where the match starts
 (when false, the default), or just after the match ends (when true).</dd>
<dd><code>occurrence</code> - If specified as an integer n (default 1), returns the
 position starting (or after) the nth match of the pattern in the string.</dd>
<dd><code>group</code> - If zero (the default), returns the position starting (or
 after) the match of the whole pattern overall, otherwise if an integer m,
 the position starting or after the mth parenthesized group in (the nth
 occurrence of) the pattern.</dd>
<dd><code>w3cNewlines</code> - Pass true to allow the regular expression to recognize
 newlines according to the W3C XQuery rules rather than those of ISO SQL.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The position, in the specified units, starting or just after,
 the nth occurrence (or mth capturing group of the nth occurrence) of the
 pattern in the input string, starting from the specified position. Null
 if any parameter is null; zero if the start position is less than 1 or
 beyond the end of the string, if occurrence is less than 1 or greater
 than the number of matches, or if group is less than zero or greater than
 the number of parenthesized capturing groups in the pattern.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></code> - SQLDataException with SQLSTATE 2201S if the regular
 expression is invalid, 2201T if the flags string is invalid;
 SQLFeatureNotSupportedException (0A000) if (in the current
 implementation) usingOctets is true, or w3cNewlines is false or omitted.</dd>
</dl>
</li>
</ul>
<a id="substring_regex(java.lang.String,java.lang.String,java.lang.String,int,boolean,int,int,boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>substring_regex</h4>
<pre class="methodSignature">@Function(schema="javatest")
public static&nbsp;<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;<a href="../../../../../src-html/org/postgresql/pljava/example/saxon/S9.html#line.3200">substring_regex</a>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;pattern,
                                     @SQLType(name="\"in\"")
                                     <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;in,
                                     @SQLType(defaultValue="")
                                     <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;flag,
                                     @SQLType(name="\"from\"",defaultValue="1")
                                     int&nbsp;from,
                                     @SQLType(defaultValue="false")
                                     boolean&nbsp;usingOctets,
                                     @SQLType(defaultValue="1")
                                     int&nbsp;occurrence,
                                     @SQLType(name="\"group\"",defaultValue="0")
                                     int&nbsp;group,
                                     @SQLType(defaultValue="false")
                                     boolean&nbsp;w3cNewlines)
                              throws <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></pre>
<div class="block">Syntax-sugar-free form of the ISO SQL
 <a id='substring_regex'><code>SUBSTRING_REGEX</code></a> function:
 return a substring specified by a pattern match in a string.
<p>
 Rewrite the standard form
<pre>
 SUBSTRING_REGEX(pattern FLAG flags IN str FROM position
                 OCCURRENCE n GROUP m)
</pre>
 into this form:
<pre>
 substring_regex(pattern, flag =&gt; flags, "in" =&gt; str,
                 "from" =&gt; position, occurrence =&gt; n,
                 "group" =&gt; m)
</pre>
 where all of the named parameters are optional except pattern and "in".
 See also <a href="#position_regex(java.lang.String,java.lang.String,java.lang.String,int,boolean,boolean,int,int,boolean)"><code>position_regex</code></a> regarding the
 <code>occurrence</code> and <code>"group"</code> parameters,
 <a href="#occurrences_regex(java.lang.String,java.lang.String,java.lang.String,int,boolean,boolean)"><code>occurrences_regex</code></a> regarding
 <code>usingOctets</code>, and <a href="#like_regex(java.lang.String,java.lang.String,java.lang.String,boolean)"><code>like_regex</code></a>
 regarding <code>w3cNewlines</code>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>pattern</code> - XQuery regular expression to seek in the input string.</dd>
<dd><code>in</code> - The input string.</dd>
<dd><code>flag</code> - Optional string of
 <a href='https://www.w3.org/TR/xpath-functions-31/#flags'>flags adjusting
 the regular expression behavior</a>.</dd>
<dd><code>from</code> - Starting position in the input string, 1 by default.</dd>
<dd><code>usingOctets</code> - Whether position is counted in characters (actual
 Unicode characters, not any smaller encoded unit, not even Java char),
 which is the default, or (when true) in octets of the string's encoded
 form.</dd>
<dd><code>occurrence</code> - If specified as an integer n (default 1), returns the
 nth match of the pattern in the string.</dd>
<dd><code>group</code> - If zero (the default), returns the match of the whole
 pattern overall, otherwise if an integer m, the match of the mth
 parenthesized group in (the nth occurrence of) the pattern.</dd>
<dd><code>w3cNewlines</code> - Pass true to allow the regular expression to recognize
 newlines according to the W3C XQuery rules rather than those of ISO SQL.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The substring matching the nth occurrence (or mth capturing group
 of the nth occurrence) of the pattern in the input string, starting from
 the specified position. Null if any parameter is null, if the start
 position is less than 1 or beyond the end of the string, if occurrence is
 less than 1 or greater than the number of matches, or if group is less
 than zero or greater than the number of parenthesized capturing groups in
 the pattern.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></code> - SQLDataException with SQLSTATE 2201S if the regular
 expression is invalid, 2201T if the flags string is invalid;
 SQLFeatureNotSupportedException (0A000) if (in the current
 implementation) usingOctets is true, or w3cNewlines is false or omitted.</dd>
</dl>
</li>
</ul>
<a id="translate_regex(java.lang.String,java.lang.String,java.lang.String,java.lang.String,int,boolean,int,boolean)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>translate_regex</h4>
<pre class="methodSignature">@Function(schema="javatest")
public static&nbsp;<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;<a href="../../../../../src-html/org/postgresql/pljava/example/saxon/S9.html#line.3301">translate_regex</a>&#8203;(<a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;pattern,
                                     @SQLType(name="\"in\"")
                                     <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;in,
                                     @SQLType(defaultValue="")
                                     <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;flag,
                                     @SQLType(name="\"with\"",defaultValue="")
                                     <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.base/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;with,
                                     @SQLType(name="\"from\"",defaultValue="1")
                                     int&nbsp;from,
                                     @SQLType(defaultValue="false")
                                     boolean&nbsp;usingOctets,
                                     @SQLType(defaultValue="0")
                                     int&nbsp;occurrence,
                                     @SQLType(defaultValue="false")
                                     boolean&nbsp;w3cNewlines)
                              throws <a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></pre>
<div class="block">Syntax-sugar-free form of the ISO SQL
 <a id='translate_regex'><code>TRANSLATE_REGEX</code></a> function:
 return a string constructed from the input string by replacing one
 specified occurrence, or all occurrences, of a matching pattern.
<p>
 Rewrite the standard forms
<pre>
 TRANSLATE_REGEX(pattern FLAG flags IN str WITH repl FROM position
                 OCCURRENCE ALL)
 TRANSLATE_REGEX(pattern FLAG flags IN str WITH repl FROM position
                 OCCURRENCE n)
</pre>
 into these forms, respectively:
<pre>
 translate_regex(pattern, flag =&gt; flags, "in" =&gt; str,
                 "with" =&gt; repl, "from" =&gt; position)
 translate_regex(pattern, flag =&gt; flags, "in" =&gt; str,
                 "with" =&gt; repl, "from" =&gt; position,
                 occurrence =&gt; n)
</pre>
 where all of the named parameters are optional except pattern and "in"
 (the default for "with" is the empty string, resulting in matches being
 deleted).
 See also <a href="#position_regex(java.lang.String,java.lang.String,java.lang.String,int,boolean,boolean,int,int,boolean)"><code>position_regex</code></a> regarding the
 <code>occurrence</code> parameter,
 <a href="#occurrences_regex(java.lang.String,java.lang.String,java.lang.String,int,boolean,boolean)"><code>occurrences_regex</code></a> regarding
 <code>usingOctets</code>, and <a href="#like_regex(java.lang.String,java.lang.String,java.lang.String,boolean)"><code>like_regex</code></a>
 regarding <code>w3cNewlines</code>.
<p>
 For the specified occurrence (or all occurrences), the matching portion
 <em>s</em> of the string is replaced as by the XQuery function
 <a href='https://www.w3.org/TR/xpath-functions-31/#func-replace'>replace</a>(<em>s, pattern, repl, flags</em>). The <em>repl</em> string
 may contain <code>$0</code> to refer to the entire matched substring, or
 <code>$</code><em>m</em> to refer to the <em>m</em>th parenthesized capturing
 group in the pattern.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>pattern</code> - XQuery regular expression to seek in the input string.</dd>
<dd><code>in</code> - The input string.</dd>
<dd><code>flag</code> - Optional string of
 <a href='https://www.w3.org/TR/xpath-functions-31/#flags'>flags adjusting
 the regular expression behavior</a>.</dd>
<dd><code>with</code> - The replacement string, possibly with $m references.</dd>
<dd><code>from</code> - Starting position in the input string, 1 by default.</dd>
<dd><code>usingOctets</code> - Whether position is counted in characters (actual
 Unicode characters, not any smaller encoded unit, not even Java char),
 which is the default, or (when true) in octets of the string's encoded
 form.</dd>
<dd><code>occurrence</code> - If specified as an integer n (default 0 for "ALL"),
 replace the nth match of the pattern in the string.</dd>
<dd><code>w3cNewlines</code> - Pass true to allow the regular expression to recognize
 newlines according to the W3C XQuery rules rather than those of ISO SQL.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The input string with one occurrence or all occurences of the
 pattern replaced, as described above. Null if any parameter is null, or
 if the start position is less than 1 or beyond the end of the string.
 The input string unchanged if occurrence is less than zero or exceeds the
 number of matches.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/12/docs/api/java.sql/java/sql/SQLException.html?is-external=true" title="class or interface in java.sql" class="externalLink">SQLException</a></code> - SQLDataException with SQLSTATE 2201S if the regular
 expression is invalid, 2201T if the flags string is invalid; 2201U if
 replacing where the pattern has matched a substring of zero length; 2201V
 if the replacement string has improper form (a backslash must be used to
 escape any dollar sign or backslash intended literally);
 SQLFeatureNotSupportedException (0A000) if (in the current
 implementation) usingOctets is true, or w3cNewlines is false or omitted.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/S9.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2003&#x2013;2024<a href='http://tada.se/eng/'>Tada AB</a></small></p>
</footer>
</body>
</html>
