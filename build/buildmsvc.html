<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/markdown/build/buildmsvc.md at 2024-10-19

 | Rendered using Apache Maven Default Skin
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>PostgreSQL PL/Java &#x2013; Building PL/Java with Microsoft Visual Studio</title>
    <link rel="stylesheet" href="../css/maven-base.css" />
    <link rel="stylesheet" href="../css/maven-theme.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
  </head>
  <body class="composite">
    <div id="banner">
<a href="https://tada.github.io/pljava/" id="bannerLeft" title="PL/Java logo combining the PostgreSQL elephant and a Java bean"><img src="../images/pljava_logo.jpg"  alt="PL/Java logo combining the PostgreSQL elephant and a Java bean"/></a>      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2024-10-19</span>
           | <span id="projectVersion">Version: 1.6.8</span>
      </div>
      <div class="xright"><a href="https://github.com/tada/pljava/wiki/" class="externalLink" title="Wiki">Wiki</a> |
<a href="https://github.com/tada/pljava/issues" class="externalLink" title="Issues">Issues</a> |
<a href="https://www.postgresql.org/list/pljava-dev/" class="externalLink" title="Mailing list">Mailing list</a> |
<a href="https://github.com/tada/pljava/tree/master/" class="externalLink" title="Code">Code</a>      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>Usage</h5>
    <ul>
     <li class="none"><a href="../build/build.html" title="Building PL/Java">Building PL/Java</a></li>
     <li class="none"><a href="../install/install.html" title="Installing into PostgreSQL">Installing into PostgreSQL</a></li>
     <li class="none"><a href="../install/upgrade.html" title="Upgrading">Upgrading</a></li>
     <li class="none"><a href="../build/package.html" title="Packaging PL/Java">Packaging PL/Java</a></li>
     <li class="none"><a href="../use/use.html" title="User guide">User guide</a></li>
     <li class="none"><a href="../develop/develop.html" title="Developer notes">Developer notes</a></li>
    </ul>
       <h5>Release Information</h5>
    <ul>
     <li class="none"><a href="../releasenotes.html" title="Release notes">Release notes</a></li>
    </ul>
       <h5>Modules</h5>
    <ul>
     <li class="none"><a href="../pljava-api/index.html" title="PL/Java API">PL/Java API</a></li>
     <li class="none"><a href="../pljava/index.html" title="PL/Java backend Java code">PL/Java backend Java code</a></li>
     <li class="none"><a href="../pljava-so/index.html" title="PL/Java backend native code">PL/Java backend native code</a></li>
     <li class="none"><a href="../pljava-ant/index.html" title="PL/Java Ant tasks">PL/Java Ant tasks</a></li>
     <li class="none"><a href="../pljava-examples/index.html" title="PL/Java examples">PL/Java examples</a></li>
     <li class="none"><a href="../pljava-packaging/index.html" title="PL/Java packaging">PL/Java packaging</a></li>
     <li class="none"><a href="../pljava-pgxs/index.html" title="PL/Java PGXS">PL/Java PGXS</a></li>
    </ul>
       <h5>Project Documentation</h5>
    <ul>
     <li class="collapsed"><a href="../project-info.html" title="Project Information">Project Information</a></li>
    </ul>
      <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
<h1>Building PL/Java with Microsoft Visual Studio</h1>
<p>PL/Java may be built on Windows using the compilers in Microsoft Visual Studio
(including the Express and Community editions).</p>
<p>Most Windows users will install PostgreSQL using the binary distributions from
<a class="externalLink" href="http://www.enterprisedb.com/products-services-training/pgdownload">EnterpriseDB</a>. You may find that using the same version of Visual Studio
to compile PL/Java as that used by EnterpriseDB to compile their PostgreSQL
distribution will result in fewer compile warnings and a somewhat smaller
runtime memory footprint because the same runtime DLLs will be used by both
PostgreSQL and PL/Java. Using a <i>newer</i> version of Visual Studio (including
the Community 2015 version) will generally work, while older versions are more
likely to be problematic.</p><section>
<h2><a name="Software_Prerequisites"></a>Software Prerequisites</h2>
<ol style="list-style-type: decimal">

<li>

<p>You will need an appropriate version of <a class="externalLink" href="https://www.visualstudio.com/downloads/download-visual-studio-vs">Microsoft Visual Studio</a>. When
installing Visual Studio be sure to select the &#x201c;compiler tools&#x201d; option so
that the command line compiler is installed.</p>
</li>
<li>

<p>The <a class="externalLink" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java Development Kit</a> (not just the Java Runtime Environment)
version that you plan to use. that you plan to use should be installed, also
ideally in your PATH environment variable so that</p>

<div class="source">
<pre><code> javac  -version
</code></pre></div>
<p>just works.</p>
</li>
<li>

<p>The PostgreSQL server version that you intend to use should be installed,
and on your PATH so that the command</p>

<div class="source">
<pre><code> pg_config
</code></pre></div>
<p>succeeds.</p>
</li>
<li>

<p>Development files (mostly <code>.h</code> files) for that PostgreSQL version must also
be installed. To check, look in the output of that <code>pg_config</code> command for
an <code>INCLUDEDIR-SERVER</code> line, and list the directory it refers to. There
should be a bunch of <code>*.h</code> files there.</p>
</li>
<li>

<p>You will need to install <a class="externalLink" href="https://maven.apache.org/">Maven</a> and add it to your PATH so that</p>

<div class="source">
<pre><code> mvn --version
</code></pre></div>
<p>just works.</p>
</li>
<li>

<p>You will need either <a class="externalLink" href="https://git-scm.com/downloads">Git</a> or <a class="externalLink" href="https://desktop.github.com/">GitHub for Windows</a>. If you are
using Git, add it to your PATH so that</p>

<div class="source">
<pre><code> git --version
</code></pre></div>
<p>just works.</p>
</li>
</ol>
<p>You <b>must</b> match the 32-bit vs 64-bit version of the Java JVM, C compiler and
PostgreSQL installation  used to build PL/Java. (All must be either 32-bit or
64-bit.)</p>
<p>If you have more than one version installed of PostgreSQL, Java, or the
compile/link tools, make sure the ones found on your search path are the
ones you plan to use, and the version-test commands above give the output
you expect.</p></section><section>
<h2><a name="Visual_C_Configuration"></a>Visual C Configuration</h2>
<p>You will need to open a command window with the appropriate Visual C native
tools environment variables defined. You may do this by using the preconfigured
links accessible from the Start menu (for example at
<code>Visual Studio 2013 | Visual Studio Tools</code>) or by creating a desktop shortcut
for the tools.</p>
<ul>

<li>

<p>Visual Studio 2013:</p>

<div class="source">
<pre><code>  &quot;C:\Program Files (x86)\Microsoft Visual Studio 12.0\VC\vcvarsall.bat&quot; x86
  &quot;C:\Program Files (x86)\Microsoft Visual Studio 12.0\VC\vcvarsall.bat&quot; amd64
</code></pre></div>
</li>
<li>

<p>Visual Studio 2010:</p>

<div class="source">
<pre><code>  &quot;C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat&quot; x86
  &quot;C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat&quot; amd64
</code></pre></div>
</li>
</ul></section><section>
<h2><a name="Obtaining_PL.2FJava_sources"></a>Obtaining PL/Java sources</h2><section>
<h3><a name="Sources_for_a_specific_release"></a>Sources for a specific release</h3>
<p>Obtain source for a specific PL/Java release from the
<a class="externalLink" href="https://github.com/tada/pljava/releases">Releases page on GitHub</a>, archived in your choice of <code>zip</code> or <code>tar.gz</code>
format.</p>
<p>If you have <code>git</code>, you can also obtain specific-release source by cloning
the repository and checking out the tag that identifies the release.</p></section><section>
<h3><a name="Current_development_sources"></a>Current development sources</h3>
<p>The best way to obtain up-to-date development PL/Java sources is to <code>clone</code>
the PL/Java GitHub repository, which can be done with GitHub for Windows by
opening your browser to</p>

<div class="source">
<pre><code>https://github.com/tada/pljava
</code></pre></div>
<p>and clicking on the appropriate icon. At the time these notes were written, the
icon is located to the left of the &#x201c;Download ZIP&#x201d; button.</p>
<p>Alternatively you may use <a class="externalLink" href="https://git-scm.com/downloads">git</a> to <code>clone</code> the PL/Java GitHub repository,
using either of these commands:</p>

<div class="source">
<pre><code>git clone https://github.com/tada/pljava.git
git clone ssh://git@github.com/tada/pljava.git
</code></pre></div>
<p>The second only works if you have a GitHub account, but has the advantage
of being faster if you do <code>git pull</code> later on to stay in sync with updated
sources.</p></section></section><section>
<h2><a name="Building_PL.2FJava"></a>Building PL/Java</h2>
<ol style="list-style-type: decimal">

<li>

<p>Open a command window using the Visual Studio shortcut for the appropriate
version.</p>
</li>
<li>

<p>To start the build, your current directory should be the one the sources were
checked out into. In the
command window, change the directory to the location of the cloned PL/Java
repository. For example,</p>

<div class="source">
<pre><code> cd C:\GitHub\pljava
</code></pre></div>
<p>Looking around, there should be a <code>pom.xml</code> file there,
and several subdirectories <code>pljava</code>, <code>pljava-api</code>, <code>pljava-so</code>, etc.</p>
</li>
<li>

<p>PL/Java is built using <a class="externalLink" href="https://maven.apache.org/">Apache Maven</a>.</p>

<div class="source">
<pre><code> mvn  clean  install
</code></pre></div>
<p>This command will build PL/Java and produce the files you need, but
does not install them as a language in PostgreSQL. To complete that step,
proceed to the <a href="../install/install.html">installation instructions</a>.</p>
</li>
</ol>
<p>A successful <code>mvn clean install</code> should produce output like this near the end:</p>

<div class="source">
<pre><code>[INFO] PostgreSQL PL/Java ................................ SUCCESS
[INFO] PL/Java API ....................................... SUCCESS
[INFO] PL/Java backend Java code ......................... SUCCESS
[INFO] PL/Java backend native code ....................... SUCCESS
[INFO] PL/Java Deploy .................................... SUCCESS
[INFO] PL/Java Ant tasks ................................. SUCCESS
[INFO] PL/Java examples .................................. SUCCESS
[INFO] PL/Java packaging ................................. SUCCESS
</code></pre></div>
<p>(the real output will include timings on each line). You will then be ready
to <a href="../install/install.html">try out PL/Java in PostgreSQL</a>.</p><section>
<h3><a name="I_know_PostgreSQL_and_PGXS._Explain_Maven.21"></a>I know PostgreSQL and PGXS. Explain Maven!</h3>
<p>If Maven is unfamiliar, please see the &#x201c;Explain Maven!&#x201d; section on the
<a href="build.html">main build page</a>, which covers most of the subject. However,
there are some Windows-specific details:</p>
<ul>

<li>

<p>The Maven project has an extra page on <a class="externalLink" href="https://maven.apache.org/guides/getting-started/windows-prerequisites.html">Windows prerequisites</a>.</p>
</li>
<li>

<p>They don't very clearly document the location of your Maven settings file
when running on Windows. If you want to change any Maven settings, it may
be easiest to run</p>

<div class="source">
<pre><code>  mvn -X
</code></pre></div>
<p>and look for the lines</p>

<div class="source">
<pre><code>  [DEBUG] Reading global settings from (somewhere)/settings.xml
  [DEBUG] Reading user settings from (somewhere)/settings.xml
</code></pre></div>
<p>to find and edit a settings file.</p>
</li>
</ul>
<p>A last reminder, <code>mvn install</code> does not add PL/Java as a language in your
PostgreSQL database; the Maven <code>install</code> goal only adds things to your
Maven repository. That isn't even necessary for installing the language in
PostgreSQL, but it will be convenient when you
<a href="../use/hello.html">build your Java projects that <i>use</i> PL/Java</a>.</p>
<p>To &#x201c;install&#x201d; your built PL/Java as a language in PostgreSQL, proceed to
the <a href="../install/install.html">installation instructions</a>.</p></section><section>
<h3><a name="I_know_Java_and_Maven._Explain_the_PostgreSQL_picture.21"></a>I know Java and Maven. Explain the PostgreSQL picture!</h3>
<p>The process of downloading and building PL/Java with Maven will be familiar
to you, but the step saving artifacts into the local repository with the
<code>install</code> goal is only a first step; PostgreSQL itself
is not Maven-aware and will not find them there. After the <code>mvn clean install</code>,
just proceed to the <a href="../install/install.html">installation instructions</a>.</p>
<p>The <code>pljava-api</code> subproject does benefit from being saved in your local
Maven repository; you can then declare it like any other Maven
dependency when <a href="../use/hello.html">building your own projects that <i>use</i> PL/Java</a>.</p></section><section>
<h3><a name="Troubleshooting_the_build"></a>Troubleshooting the build</h3>
<p>There is an extensive &#x201c;troubleshooting the build&#x201d; section
on the <a href="build.html">main build page</a>.</p></section></section>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2003&#x2013;2024<a href="http://tada.se/eng/">Tada AB</a>.
.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
